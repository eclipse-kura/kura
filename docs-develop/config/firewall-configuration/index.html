
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Firewall Configuration - Eclipse Kura™ Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#firewall-configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
Eclipse Kura™ 5.2.0 is available! Check out the new release at: <a href="https://www.eclipse.org/kura/downloads.php">Eclipse Kura Downloads</a>.

          </div>
        </aside>
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
            <div class="md-banner__inner md-grid md-typeset">
              
You are viewing the documentation relative to the develop branch or to an outdated version. This means the features might be different than the ones of the latest stable release, or not yet published.
<a href="../../.."> 
    <strong>Click here to go to latest stable release.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Eclipse Kura™ Documentation" class="md-header__button md-logo" aria-label="Eclipse Kura™ Documentation" data-md-component="logo">
      
  <img src="../../assets/kura_logo_small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Eclipse Kura™ Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Firewall Configuration
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../intro/intro/" class="md-tabs__link">
        Introduction
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../console/" class="md-tabs__link md-tabs__link--active">
        Configuration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../builtin/intro/" class="md-tabs__link">
        Built-in services
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../admin/directory-layout/" class="md-tabs__link">
        Administration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../cloud-api/overview/" class="md-tabs__link">
        Cloud Connection API and usage
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Eclipse Kura™ Documentation" class="md-nav__button md-logo" aria-label="Eclipse Kura™ Documentation" data-md-component="logo">
      
  <img src="../../assets/kura_logo_small.png" alt="logo">

    </a>
    Eclipse Kura™ Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/intro/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/raspberry-pi-raspbian-quick-start/" class="md-nav__link">
        Raspberry Pi - Raspbian Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/raspberry-pi-ubuntu-20-quick-start/" class="md-nav__link">
        Raspberry Pi - Ubuntu 20 Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/docker-quick-start/" class="md-nav__link">
        Docker Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/intel-up-2-quick-start/" class="md-nav__link">
        Intel Up² Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/nvidia-jetson-nano-quick-start/" class="md-nav__link">
        NVIDIA Jetson Nano&trade; - Quick Start
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../console/" class="md-nav__link">
        Gateway Administration Console
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../device-information/" class="md-nav__link">
        Device Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gateway-status/" class="md-nav__link">
        Gateway Status
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../network-configuration/" class="md-nav__link">
        Network Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ethernet-configuration/" class="md-nav__link">
        Ethernet Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wi-fi-configuration/" class="md-nav__link">
        Wi-Fi Configuration
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Firewall Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Firewall Configuration
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#firewall-linux-configuration" class="md-nav__link">
    Firewall Linux Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-ports" class="md-nav__link">
    Open Ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port-forwarding" class="md-nav__link">
    Port Forwarding
  </a>
  
    <nav class="md-nav" aria-label="Port Forwarding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#port-forwarding-example" class="md-nav__link">
    Port Forwarding example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip-forwardingmasquerading" class="md-nav__link">
    IP Forwarding/Masquerading
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-services/" class="md-nav__link">
        Cloud Connections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-service-configuration/" class="md-nav__link">
        Cloud Service Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-service-configuration/" class="md-nav__link">
        Data Service Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connection-monitors/" class="md-nav__link">
        Connection Monitors in DataService
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../message-publishing-backoff-delay/" class="md-nav__link">
        Message Publishing Backoff Delay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mqttdata-transport-service-configuration/" class="md-nav__link">
        MqttData Transport Service Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ssl-configuration/" class="md-nav__link">
        SSL Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        Gateway Administration Console Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../threat-manager/" class="md-nav__link">
        Network Threat Manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Built-in services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Built-in services" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Built-in services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/simple-artemis-mqtt-broker-service/" class="md-nav__link">
        Simple Artemis MQTT Broker Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/activemq-artemis-broker-service/" class="md-nav__link">
        ActiveMQ Artemis Broker Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/clock-service/" class="md-nav__link">
        Clock Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/deployment-service/" class="md-nav__link">
        Deployment Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/cloudcat/" class="md-nav__link">
        Cloudcat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/command-service/" class="md-nav__link">
        Command Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/h2-database/" class="md-nav__link">
        H2 Database - Features and Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/h2-database-external-connections/" class="md-nav__link">
        H2 database - Connecting external applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/position-service/" class="md-nav__link">
        Position Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/rest-service/" class="md-nav__link">
        REST Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/watchdog-service/" class="md-nav__link">
        Watchdog Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/nvidiatm-triton-server-inference-engine/" class="md-nav__link">
        Nvidia™ Triton Server inference engine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../builtin/container-orchestration-provider/" class="md-nav__link">
        Container Orchestration Provider
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Administration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administration" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Administration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/directory-layout/" class="md-nav__link">
        Directory Layout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/snapshot-management/" class="md-nav__link">
        Snapshots Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/application-management/" class="md-nav__link">
        Application Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/remote-management-with-ec/" class="md-nav__link">
        Remote Management with Everyware Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/remote-management-with-kapua/" class="md-nav__link">
        Remote Management with Eclipse Kapua
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/keystore-management/" class="md-nav__link">
        Keystores Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/keys-and-certificates/" class="md-nav__link">
        Keys and Certificates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Cloud Connection API and usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cloud Connection API and usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cloud Connection API and usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud-api/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud-api/user-guide/" class="md-nav__link">
        User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud-api/app-dev-guide/" class="md-nav__link">
        Application developer guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud-api/stack-dev-guide/" class="md-nav__link">
        Cloud connection developer guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud-api/stack-components/" class="md-nav__link">
        Built-in Cloud Services
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#firewall-linux-configuration" class="md-nav__link">
    Firewall Linux Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-ports" class="md-nav__link">
    Open Ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port-forwarding" class="md-nav__link">
    Port Forwarding
  </a>
  
    <nav class="md-nav" aria-label="Port Forwarding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#port-forwarding-example" class="md-nav__link">
    Port Forwarding example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip-forwardingmasquerading" class="md-nav__link">
    IP Forwarding/Masquerading
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="firewall-configuration">Firewall Configuration</h1>
<p>Kura offers easy management of the Linux firewall iptables included in an IoT Gateway. Additionally, Kura provides the ability to manage network access security to an IoT Gateway through the following:</p>
<ul>
<li>
<p>Open Ports (local service rules)</p>
</li>
<li>
<p>Port Forwarding</p>
</li>
<li>
<p>IP Forwarding and Masquerading (NAT service rules)</p>
</li>
<li>
<p>'Automatic' NAT service rules</p>
</li>
</ul>
<p>Open Ports, Port Forwarding, and IP Forwarding and Masquerading are configured via respective <strong>Firewall</strong> configuration tabs. 'Automatic' NAT is enabled for each local (LAN) interface using the <strong>DHCP &amp; NAT</strong> tab of the respective interface configuration.</p>
<h2 id="firewall-linux-configuration">Firewall Linux Configuration</h2>
<p>This section describes the changes applied by Kura at the Linux networking configuration. Please read the following note before proceeding with manual changes in the Linux networking configuration.</p>
<div class="admonition warn"></div>
<p>Manual editing of the Linux networking configuration file is NOT recommended when the gateway configuration is being managed through Kura. While Linux may correctly accept manual changes, Kura may not be able to interpret the new configuration resulting in an inconsistent state.</p>
<p>When a new firewall configuration is submitted, Kura immediately applies it using the iptables service provided by the OS. Moreover, the rules are stored in the filesystem and a new Kura snapshot is generated containing the new configuration. At the next startup, the <strong>firewall</strong> service in the OS will re-apply them and Kura will check the firewall configuration against the one contained in the last snapshot. In this way, the user can update the snapshot with the needed rules and apply them to the system using the webUI or modify the <em>snapshot_0.xml</em> before the first start of Kura.</p>
<p>In order to allow a better coexistence between Kura and external applications that need to modify firewall rules, Kura writes its rules to a set of custom iptables chains. They are <em>input-kura</em>, <em>output-kura</em>, <em>forward-kura</em>, <em>forward-kura-pf</em> and <em>forward-kura-ipf</em> for the filter table and <em>input-kura</em>, <em>output-kura</em>, <em>prerouting-kura</em>, <em>prerouting-kura-pf</em>, <em>postrouting-kura</em>, <em>postrouting-kura-pf</em> and <em>postrouting-kura-ipf</em> for the nat table. The custom chains are then put in their respective standard iptables chains, as shown in the following:</p>
<pre><code>iptables -t filter -I INPUT -j input-kura
iptables -t filter -I OUTPUT -j output-kura
iptables -t filter -I FORWARD -j forward-kura
iptables -t filter -I forward-kura -j forward-kura-pf
iptables -t filter -I forward-kura -j forward-kura-ipf
iptables -t nat -I PREROUTING -j prerouting-kura
iptables -t nat -I prerouting-kura -j prerouting-kura-pf
iptables -t nat -I INPUT -j input-kura
iptables -t nat -I OUTPUT -j output-kura
iptables -t nat -I POSTROUTING -j postrouting-kura
iptables -t nat -I postrouting-kura -j postrouting-kura-pf
iptables -t nat -I postrouting-kura -j postrouting-kura-ipf
</code></pre>
<p>Even if many firewall rules can be handled by Kura, it could be that some rules cannot be filled through the Web Console. In this case, custom firewall rules may be added to the /etc/init.d/firewall_cust script manually. These rules are applied/reapplied every time the firewall service starts, that is at the gateway startup. These custom rules should not be applied to the Kura custom chains, but to the standard ones.</p>
<h2 id="open-ports">Open Ports</h2>
<p>If Kura is running on a gateway, all TCP/UDP ports are closed by default unless custom rules are added to the /etc/sysconfig/iptables file. Therefore, if a user needs to connect to a specific port on a gateway, it is insufficient to have an application listening on the desired port; the port also needs to be opened in the firewall.</p>
<p>To open a port using the Administration Console, select the <strong>Firewall</strong> option located in the <strong>System</strong> area. The <strong>Firewall</strong> configuration display appears in the main window. With the <strong>Open Ports</strong> tab selected, click the <strong>New</strong> button. The <strong>New Open Port Entry</strong> form appears.</p>
<p>The <strong>New Open Port Entry</strong> form contains the following configuration parameters:</p>
<ul>
<li>
<p><strong>Port or Port Range</strong> - specifies the port or port range (<high>:<low>) to be opened. (Required field.)</p>
</li>
<li>
<p><strong>Protocol</strong> - defines the protocol (tcp or udp). (Required field.)</p>
</li>
<li>
<p><strong>Permitted Network</strong> - only allows packets originated by a host on this network in CIDR notation (e.g. 172.16.1.0/24)</p>
</li>
<li>
<p><strong>Permitted Interface Name</strong> - only allows packets arrived on this interface.</p>
</li>
<li>
<p><strong>Unpermitted Interface Name</strong> - blocks packets arrived on this interface.</p>
</li>
<li>
<p><strong>Permitted MAC Address</strong> - only allows packets originated by this host in the format XX:XX:XX:XX:XX:XX.</p>
</li>
<li>
<p><strong>Source Port Range</strong> - only allows packets with source port in the defined range (<high>:<low>).</p>
</li>
</ul>
<p>Complete the <strong>New Open Port Entry</strong> form and click the <strong>Submit</strong> button when finished. Once the form is submitted, a new port entry will appear. Click the <strong>Apply</strong> button for the change to take effect.</p>
<p>The firewall rules related to the open ports section are stored in the <em>input-kura</em> custom chain of the filter table.</p>
<p><img alt="Net firewall" src="../images/NetFirewall.png" /></p>
<h2 id="port-forwarding">Port Forwarding</h2>
<p>Port forwarding rules are needed to establish connectivity from the WAN side to a specific port on a host that resides on a LAN behind the gateway. In this case, a routing solution may be avoided since the connection is made to a specified <em>external</em> port on a gateway, and packets are forwarded to an <em>internal</em> port on the destination host; therefore, it is not necessary to add the <em>external</em> port to the list of open ports.</p>
<p>To add a port forwarding rule, select the <strong>Port Forwarding</strong> tab on the <strong>Firewall</strong> display and click the <strong>New</strong> button. The <strong>Port Forward Entry</strong> form appears.</p>
<p>The <strong>Port Forward Entry</strong> form contains the following configuration parameters:</p>
<ul>
<li>
<p><strong>Input Interface</strong> - specifies the interface through which a packet is going to be received. (Required field.)</p>
</li>
<li>
<p><strong>Output Interface</strong> - specifies the interface through which a packet is going to be forwarded to its destination. (Required field.)</p>
</li>
<li>
<p><strong>LAN Address</strong> - supplies the IP address of the destination host. (Required field.)</p>
</li>
<li>
<p><strong>Protocol</strong> - defines the protocol (tcp or udp). (Required field.)</p>
</li>
<li>
<p><strong>External Port</strong> - provides the external destination port on the gateway unit. (Required field.)</p>
</li>
<li>
<p><strong>Internal Port</strong> - provides the port on a destination host. (Required field.)</p>
</li>
<li>
<p><strong>Enable Masquerading</strong> - defines whether masquerading is used (yes or no). If enabled, the gateway replaces the IP address of the originating host with the IP address of its own output (LAN) interface. This is needed when the destination host does not have a back route to the originating host (or default gateway route) via the gateway unit. The masquerading option is provided with port forwarding to limit gateway forwarding only to the destination port. (Required field.)</p>
</li>
<li>
<p><strong>Permitted Network</strong> - only forwards if the packet is originated from a host on this network.</p>
</li>
<li>
<p><strong>Permitted MAC Address</strong> - only forwards if the packet is originated by this host.</p>
</li>
<li>
<p><strong>Source Port Range</strong> - only forwards if the packet's source port is within the defined range.</p>
</li>
</ul>
<p>Complete the <strong>Port Forward Entry</strong> form and click the <strong>Apply</strong> button for the desired port forwarding rules to take effect.</p>
<p>The firewall rules related to the port forwarding section are stored in the <em>forward-kura-pf</em> custom chain of the filter table and in the <em>postrouting-kura-pf</em> and <em>prerouting-kura-pf</em> chains of the nat table.</p>
<h3 id="port-forwarding-example">Port Forwarding example</h3>
<p>This section describes an example of port forwarding rules. The initial setup is described below.</p>
<ul>
<li>
<p>A couple of RaspberryPi 3 that shares the same LAN over Ethernet.</p>
</li>
<li>
<p>The first RaspberryPi running Kura is configured as follows:</p>
</li>
<li>The eth0 interface static with IP address of 172.16.0.5.</li>
<li>
<p>There is no default gateway.</p>
</li>
<li>
<p>The second RaspberryPi running Kura is configured as follows:</p>
</li>
<li>The eth0 interface LAN/static with IP address of 172.16.0.1/24 and no NAT.</li>
<li>
<p>The wlan0 interface is WAN/DHCP client.</p>
</li>
<li>
<p>A laptop is connected to the same network of the wlan0 of the second RaspberryPi and can ping its wlan0 interface.</p>
</li>
</ul>
<p>The purpose of the second RaspberryPi configuration is to enable access to the Administration Console running on the first one (port 80) by connecting to the second RaspberryPi's port 8080 over the wlan. This scenario assumes that IP addresses are assigned as follows:</p>
<ul>
<li>
<p>Second RaspberryPi wlan0 - 10.200.12.6</p>
</li>
<li>
<p>Laptop wlan0 - 10.200.12.10</p>
</li>
</ul>
<p>The following port forwarding entries are added to the second RaspberryPi configuration as described above using the <strong>Port Forward Entry</strong> form:</p>
<ul>
<li>
<p>Input Interface - wlan0</p>
</li>
<li>
<p>Output Interface - eth0</p>
</li>
<li>
<p>LAN Address - 172.16.0.5</p>
</li>
<li>
<p>Protocol - tcp</p>
</li>
<li>
<p>External Port - 8080</p>
</li>
<li>
<p>Internal Port - 80</p>
</li>
<li>
<p>Masquerade - yes</p>
</li>
</ul>
<p>The <em>Permitted Network</em>, <em>Permitted MAC Address</em>, and <em>Source Port Range</em> fields are left blank.</p>
<p>The following iptables rules are applied and added to the <code>/etc/sysconfig/iptables</code> file:</p>
<pre><code>iptables -t nat -A prerouting-kura-pf -i wlan0 -p tcp -s 0.0.0.0/0 --dport 8080 -j DNAT --to 172.16.0.5:80
iptables -t nat -A postrouting-kura-pf -o eth0 -p tcp -d 172.16.0.5 -j MASQUERADE
iptables -A forward-kura-pf -i wlan0 -o eth0 -p tcp -s 0.0.0.0/0 --dport 80 -d 172.16.0.5 -j ACCEPT
iptables -A forward-kura-pf -i eth0 -o wlan0 -p tcp -s 172.16.0.5 -m state --state RELATED,ESTABLISHED -j ACCEPT
</code></pre>
<p>The following iptables commands may be used to verify that the new rules have been applied:</p>
<pre><code>sudo iptables -v -n -L
sudo iptables -v -n -L -t nat
</code></pre>
<p>At this point, it is possible to try to connect to <code>http://10.200.12.6</code> and to <code>http://10.200.12.6:8080</code> from the laptop. Note that when a connection is made to the device on port 80, it is to the Kura configuration page on the device itself (the second RaspberryPi). When the gateway is connected on port 8080, you are forwarded to the Kura Gateway Administration Console on the first RaspberryPi. The destination host can only be reached by connecting to the gateway on port 8080.</p>
<p>Another way to connect to the Kura Gateway Administration Console on the first RaspberryPi would be to add an IP Forwarding/Masquerading entry as described in the next section.</p>
<h2 id="ip-forwardingmasquerading">IP Forwarding/Masquerading</h2>
<p>The advantage of the <em>Automatic NAT</em> method is its simplicity. However, this approach does not handle reverse NATing, and it cannot be used for interfaces that are not listed in the Gateway Administration Console. To set up generic (one-to-many) NATing, select the <strong>IP Forwarding/Masquerading</strong> tab on the <strong>Firewall</strong> display. The <strong>IP Forwarding/Masquerading</strong> form appears.</p>
<p>The <strong>IP Forwarding/Masquerading</strong> form contains the following configuration parameters:</p>
<ul>
<li>
<p><strong>Input Interface</strong> - specifies the interface through which a packet is going to be received. (Required field.)</p>
</li>
<li>
<p><strong>Output Interface</strong> - specifies the interface through which a packet is going to be forwarded to its destination. (Required field.)</p>
</li>
<li>
<p><strong>Protocol</strong> - defines the protocol of the rule to check (all, tcp, or udp). (Required field.)</p>
</li>
<li>
<p><strong>Source Network/Host</strong> - identifies the source network or host name (CIDR notation). Set to 0.0.0.0/0 if empty.</p>
</li>
<li>
<p><strong>Destination Network/Host</strong> - identifies the destination network or host name (CIDR notation). Set to 0.0.0.0/0 if empty.</p>
</li>
<li>
<p><strong>Enable Masquerading</strong> - defines whether masquerading is used (yes or no). If set to 'yes', masquerading is enabled. If set to 'no', only FORWARDING rules are being added. (Required field.)</p>
</li>
</ul>
<p>The rules will be added to the <em>forward-kura-ipf</em> chain in the filter table and in the <em>postrouting-kura-ipf</em> one in the nat table.</p>
<p>As a use-case scenario, consider the same setup as in port forwarding. In this case, the interfaces of the gateway are configured as follows:</p>
<ul>
<li>
<p>eth0 - LAN/Static/No NAT 172.16.0.1/24</p>
</li>
<li>
<p>wlan0 - WAN/DHCP 10.200.12.6/24</p>
</li>
</ul>
<p>To reach the RaspberryPi unit sitting on the 172.16.0.5/24 from a specific host on the 10.200.0.0/16 network, set up the following <em>Reverse NAT</em> entry:</p>
<ul>
<li>
<p>Input Interface - wlan0 (WAN interface)</p>
</li>
<li>
<p>Output Interface - eth0 (LAN interface)</p>
</li>
<li>
<p>Protocol - tcp</p>
</li>
<li>
<p>Source Network/Host - 10.200.12.10/32</p>
</li>
<li>
<p>Destination Network/Host - 172.16.0.5/32</p>
</li>
<li>
<p>Enable Masquerading - yes</p>
</li>
</ul>
<p>This case adds the following iptables rules to the /etc/sysconfig/iptables file:</p>
<pre><code>iptables -t nat -A postrouting-kura-ipf -p tcp -s 10.200.12.6/32 -d 172.16.0.5/32 -o eth0 -j MASQUERADE
iptables -A forward-kura-ipf -p tcp -s 172.16.0.5/32 -i eth0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A forward-kura-ipf -p tcp -s 10.200.12.6/32 -d 172.16.0.5/32 -i wlan0 -o eth0 -m tcp -j ACCEPT
</code></pre>
<p>Additionally, a route to the 172.16.0.0/24 network needs to be configured on a connecting laptop as shown below:</p>
<pre><code>sudo route add -net 172.16.0.0 netmask 255.255.255.0 gw 10.200.12.6
</code></pre>
<p>Since <em>masquerading</em> is enabled, there is no need to specify the back route on the destination host. Note that with this setup, the RaspberryPi only forwards packets originating on the 10.200.12.10 laptop to the 172.16.0.5 destination.</p>
<p>If the <em>Source Network/Host</em> and <em>Destination Network/Host</em> fields are empty, iptables rules appear as follows:</p>
<pre><code>iptables -t nat -A postrouting-kura-ipf -p tcp -s 0.0.0.0/0 -d 0.0.0.0/0 -o eth0 -j MASQUERADE
iptables -A forward-kura-ipf -p tcp -s 0.0.0.0/0 -i eth0 -o wlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A forward-kura-ipf -p tcp -s 0.0.0.0/0 -d 0.0.0.0/0 -i wlan0 -o eth0 -j ACCEPT
</code></pre>
<p>The RaspberryPi forwards packets from any external host (connected to wlan0) to any destination on the local network (eth0 interface).</p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../wi-fi-configuration/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Wi-Fi Configuration" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Wi-Fi Configuration
            </div>
          </div>
        </a>
      
      
        
        <a href="../cloud-services/" class="md-footer__link md-footer__link--next" aria-label="Next: Cloud Connections" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Cloud Connections
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>