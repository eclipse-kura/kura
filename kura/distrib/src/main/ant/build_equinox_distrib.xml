<!--

    Copyright (c) 2011, 2024 Eurotech and/or its affiliates and others

    This program and the accompanying materials are made
    available under the terms of the Eclipse Public License 2.0
    which is available at https://www.eclipse.org/legal/epl-2.0/

    SPDX-License-Identifier: EPL-2.0

    Contributors:
     Eurotech
     Red Hat Inc

-->
<project name="build_equinox_distrib" default="dist-linux"
    basedir="../../../">

    <target name="install-plugin">
        <echo message="Installing ${bundle.file}, start level: ${start.level}, start: ${start}"/>
        <copy todir="${project.build.directory}/${build.output.name}/plugins/${start.level}${start}" failonerror="false" overwrite="false" file="${project.build.directory}/plugins/${bundle.file}" />
        <copy todir="${project.build.directory}/${build.output.name}/plugins/${start.level}${start}" failonerror="false" overwrite="false" file="../target-definition/common/source/plugins/${bundle.file}" />
        <copy todir="${project.build.directory}/${build.output.name}/plugins/${start.level}${start}" failonerror="false" overwrite="false" file="${kura.osgi.repo}/plugins/${bundle.file}" />
        <fail message="${bundle.file} not found">
            <condition>
                <not>
                    <available file="${project.build.directory}/${build.output.name}/plugins/${start.level}${start}/${bundle.file}" />
                </not>
            </condition>
        </fail>
    </target>

    <target name="dist-linux">

        <property name="build.output.name" value="kura_${project.version}_${build.name}" />
        <property name="kura.symlink" value="kura" />
        <property name="install.folder" value="install" />
        <property name="plugins.folder" value="plugins" />
        <property name="data.folder" value="data" />
        <property name="framework.config.folder" value="framework" />
        <property name="user.config.folder" value="user" />
        <property name="binary.folder" value="bin" />
        <property name="snapshots.folder" value="${user.config.folder}/snapshots" />
        <property name="security.folder" value="${user.config.folder}/security" />
        <property name="console.folder" value="console" />
        <property name="log4j.folder" value="log4j" />

        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/1" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/1s" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/2" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/2s" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/3" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/3s" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/4" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/4s" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/5" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/5s" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/6" />
        <mkdir dir="${project.build.directory}/${build.output.name}/plugins/6s" />

        <!-- Loads entries from a manifest file. @jar The jar from where to read
            @prefix A prefix to prepend -->
        <macrodef name="loadmf">
            <attribute name="jar" />
            <attribute name="prefix" default="" />
            <sequential>
                <loadproperties>
                    <!-- Load the manifest entries -->
                    <zipentry zipfile="@{jar}" name="META-INF/MANIFEST.MF" />
                    <!-- Add the prefix -->
                    <filterchain>
                        <prefixlines prefix="@{prefix}" />
                    </filterchain>
                </loadproperties>
            </sequential>
        </macrodef>

        <macrodef name="find-jar-version">
            <attribute name="dir" />
            <attribute name="prefix" />
            <attribute name="property" />
            <sequential>
                <fileset dir="@{dir}" id="target.path">
                    <include name="@{prefix}_*.jar" />
                </fileset>
                <pathconvert property="@{property}" refid="target.path">
                    <mapper type="regexp" from=".*/@{prefix}_(.*).jar" to="\1" />
                </pathconvert>
            </sequential>
        </macrodef>

        <echo message="Building Kura Distribution for ${build.output.name}..." />

        <copy file="src/main/resources/${build.name}/kura.properties"
            tofile="${project.build.directory}/${build.output.name}/kura.properties" />
        <propertyfile
            file="${project.build.directory}/${build.output.name}/kura.properties">
            <entry key="kura.version" value="KURA_${kura.version}" />
            <entry key="kura.home" value="${kura.install.dir}/${kura.symlink}" />
            <entry key="kura.framework.config"
                value="${kura.install.dir}/${kura.symlink}/${framework.config.folder}" />
            <entry key="kura.user.config"
                value="${kura.install.dir}/${kura.symlink}/${user.config.folder}" />
            <entry key="kura.plugins"
                value="${kura.install.dir}/${kura.symlink}/${plugins.folder}" />
            <entry key="kura.packages"
                value="${kura.install.dir}/${kura.symlink}/packages" />

            <entry key="kura.marketplace.compatibility.version" value="KURA_${kura.version}" />

            <entry key="kura.data" value="${kura.install.dir}/${kura.symlink}/${data.folder}" />
            <entry key="kura.snapshots"
                value="${kura.install.dir}/${kura.symlink}/${snapshots.folder}" />
            <entry key="kura.style.dir"
                value="${kura.install.dir}/${kura.symlink}/${console.folder}/skin" />

            <entry key="version" value="${kura.version}" />
            <entry key="build.version" value="${buildNumber}" />
            <entry key="build.number" value="${build.name}-${buildNumber}" />
        </propertyfile>
        <replace
            file="${project.build.directory}/${build.output.name}/kura.properties"
            token="{kura.install.dir}" value="${kura.install.dir}" />
        <replace
            file="${project.build.directory}/${build.output.name}/kura.properties"
            token="{kura.symlink}" value="${kura.symlink}" />


        <condition property="kura.osgi.repo"
            value="../../target-platform/p2-repo-equinox_3.16.0/target/source">
            <or>
                <not>
                    <isset property="kura.osgi" />
                </not>
                <equals arg1="${kura.osgi}" arg2="equinox" />
            </or>
        </condition>
        <condition property="is.nn">
            <contains string="${build.name}" substring="-nn" />
        </condition>
        <condition property="is.docker">
            <contains string="${build.name}" substring="docker" />
        </condition>

        <copy file="src/main/resources/${build.name}/snapshot_0.xml"
            tofile="${project.build.directory}/${build.output.name}/snapshot_0.xml" failonerror="false" />
        <copy file="src/main/osgi/equinox_3.16.0/configuration/config.ini"
            tofile="${project.build.directory}/${build.output.name}/config.ini" />

        <!-- Copy jdk.dio files -->
        <antcall target="copy-jdk-dio-resources" />

        <copy file="src/main/resources/common/cacerts.ks"
            tofile="${project.build.directory}/${build.output.name}/cacerts.ks" />


        <!-- Populate config.ini with correct OSGi packages -->
        <antcall target="osgi-base-plugins" />

        <!-- Populate config.ini with correct versions -->
        <replace file="${project.build.directory}/${build.output.name}/config.ini"
            token="{kura.build.version}" value="${kura.build.version}" />

        <!-- Populate config.ini with correct Kura bundles -->
        <antcall target="api-plugins" />
        <antcall target="core-plugins" />
        <antcall target="core.system-plugins" />
        <antcall target="core.certificates-plugins" />
        <antcall target="core.cloud-plugins" />
        <antcall target="cloud.mqtt.kapua-plugins" />
        <antcall target="cloud.mqtt.eclipseiot-plugins" />
        <antcall target="cloud.mqtt.raw-plugins" />
        <antcall target="core.comm-plugins" />
        <antcall target="core.configuration-plugins" />
        <antcall target="core.crypto-plugins" />
        <antcall target="core.deployment-plugins" />
        <antcall target="core.identity-plugins" />
        <antcall target="core.inventory-plugins" />
        <antcall target="core.tamper-plugins" />
        <antcall target="core.net-plugins" />
        <antcall target="core.status-plugins" />
        <antcall target="deployment.agent-plugins" />
        <antcall target="linux.clock-plugins" />
        <antcall target="linux.command-plugins" />
        <antcall target="linux.position-plugins" />
        <antcall target="linux.usb-plugins" />
        <antcall target="bluetooth-plugins" />
        <antcall target="linux.watchdog-plugins" />
    	<antcall target="h2db-plugins" />

        <!-- Added Camel bundles configs -->
        <antcall target="camel-plugins" />

        <!-- Rest bundles config -->
        <antcall target="rest-plugins" />
    	
        <!-- Asset bundles config -->
        <antcall target="asset-plugins" />

        <!-- Added Artemis bundles configs -->
        <antcall target="artemis-plugins" />

        <!-- Deployment hook bundles configs -->
        <antcall target="deployment-hooks-plugins" />

        <!-- Marshalling bundles configs -->
        <antcall target="marshallers-plugins" />

        <!-- Wires bundles config -->
        <antcall target="wires-plugins" />

        <!-- Miscellaneous bundles config -->
        <antcall target="misc-plugins" />

        <!-- Keystore Management bundles config -->
        <antcall target="keystore-management-plugins" />

        <!-- Filesystem log provider bundle config -->
        <antcall target="filesystem-logprovider-plugins" />
        
        <antcall target="container-orchestrator-plugins" />

        <antcall target="configuration.change.manager-plugins" />

        <antcall target="event-publisher-plugins" />

        <!-- Conditional entries. Check for jar presence, and invoke relevant ant
            target -->
        <available
            file="${project.build.directory}/plugins/org.eclipse.kura.web2_${org.eclipse.kura.web2.version}.jar"
            property="is.web2.jar.available" />
        <antcall target="web2-plugins" />

        <available
            file="${project.build.directory}/plugins/org.eclipse.kura.linux.gpio_${org.eclipse.kura.linux.gpio.version}.jar"
            property="linux.gpio.jar.present" />
        <antcall target="gpio-plugins" />
        <antcall target="emulator-gpio-plugins" />
        <antcall target="emulator-plugins" />
        <antcall target="linux-network-plugins" />

        <!-- Add mToolkit to distribution -->
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.tigris.mtoolkit.iagent.rpc_3.0.0.20110411-0918.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>

        <propertyfile
            file="${project.build.directory}/${build.output.name}/dpa.properties">
            <entry key="kura"
                value="file:${kura.install.dir}/${kura.symlink}/packages/${build.output.name}.dp" />
        </propertyfile>

        <!-- Create the Kura start scripts -->
        <echo file="${project.build.directory}/${build.output.name}/start_kura.sh"
            append="false"><![CDATA[#!/bin/sh

export PATH=/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/opt/jvm/bin:/usr/java/bin:$PATH
export MALLOC_ARENA_MAX=1

DIR=$(cd $(dirname $0)/..; pwd)
cd $DIR

# set up the configuration area
mkdir -p /tmp/.kura/configuration
${DIR}/bin/gen_config_ini.sh ${DIR}/framework/config.ini ${DIR}/plugins > /tmp/.kura/configuration/config.ini

KURA_RUNNING=`ps ax | grep java | grep "org.eclipse.equinox"`

#get java version
JAVA_VERSION=$(java -version 2>&1 | awk -F '"' '/version/ {print $2}')
JAVA_VERSION_NUM=$(echo "$JAVA_VERSION" | awk -F. '{printf("%03d%03d",$1,$2);}')

OPEN_MODULE_OPTIONS=''

if [ $JAVA_VERSION_NUM -gt 001008 ] ; then
        OPEN_MODULE_OPTIONS="--add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED"
fi

if [ -z "$KURA_RUNNING" ] ; then
        exec java -Xms${kura.mem.size} -Xmx${kura.mem.size} \
        -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/var/log/kura-heapdump.hprof \
        -XX:ErrorFile=/var/log/kura-error.log \
        -XX:+IgnoreUnrecognizedVMOptions \
        ${OPEN_MODULE_OPTIONS} \
        --add-modules=ALL-SYSTEM \
        -Dkura.os.version=${kura.os.version} \
        -Dkura.arch=${kura.arch} \
        -Dtarget.device=${target.device} \
        -Declipse.ignoreApp=true \
        -Dkura.home=${DIR} \
        -Dkura.configuration=file:${DIR}/framework/kura.properties \
        -Dkura.custom.configuration=file:${DIR}/user/kura_custom.properties \
        -Ddpa.configuration=${DIR}/packages/dpa.properties \
        -Dlog4j.configurationFile=file:${DIR}/log4j/log4j.xml \
        -Djava.security.policy=${DIR}/framework/jdk.dio.policy \
        -Djdk.dio.registry=${DIR}/framework/jdk.dio.properties \
        -Djdk.tls.trustNameService=true \
        -Dosgi.console \
        -Declipse.consoleLog=true \
        -jar ${DIR}/plugins/org.eclipse.equinox.launcher_${org.eclipse.equinox.launcher.version}.jar \
        -configuration  /tmp/.kura/configuration
else
        echo "Failed to start Kura. It is already running ..."
fi]]>
        </echo>
        <echo
            file="${project.build.directory}/${build.output.name}/start_kura_debug.sh"
            append="false"><![CDATA[#!/bin/sh

export PATH=/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/opt/jvm/bin:/usr/java/bin:$PATH
export MALLOC_ARENA_MAX=1

DIR=$(cd $(dirname $0)/..; pwd)
cd $DIR

# set up the configuration area
mkdir -p /tmp/.kura/configuration
${DIR}/bin/gen_config_ini.sh ${DIR}/framework/config.ini ${DIR}/plugins > /tmp/.kura/configuration/config.ini

KURA_RUNNING=`ps ax | grep java | grep "org.eclipse.equinox"`

#get java version
JAVA_VERSION=$(java -version 2>&1 | awk -F '"' '/version/ {print $2}')
JAVA_VERSION_NUM=$(echo "$JAVA_VERSION" | awk -F. '{printf("%03d%03d",$1,$2);}')

OPEN_MODULE_OPTIONS=''

if [ $JAVA_VERSION_NUM -gt 001008 ] ; then
        OPEN_MODULE_OPTIONS="--add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED"
fi

if [ -z "$KURA_RUNNING" ] ; then
        exec java -Xms${kura.mem.size} -Xmx${kura.mem.size} \
        -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -Xloggc:/var/log/kura-gc.log \
        -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=100M \
        -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/var/log/kura-heapdump.hprof \
        -XX:ErrorFile=/var/log/kura-error.log \
        -XX:+IgnoreUnrecognizedVMOptions \
        ${OPEN_MODULE_OPTIONS} \
        --add-modules=ALL-SYSTEM \
        -Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=*:8000,suspend=n \
        -Dkura.os.version=${kura.os.version} \
        -Dkura.arch=${kura.arch} \
        -Dtarget.device=${target.device} \
        -Declipse.ignoreApp=true \
        -Dkura.home=${DIR} \
        -Dkura.configuration=file:${DIR}/framework/kura.properties \
        -Dkura.custom.configuration=file:${DIR}/user/kura_custom.properties \
        -Ddpa.configuration=${DIR}/packages/dpa.properties \
        -Dlog4j.configurationFile=file:${DIR}/log4j/log4j.xml \
        -Djava.security.policy=${DIR}/framework/jdk.dio.policy \
        -Djdk.dio.registry=${DIR}/framework/jdk.dio.properties \
        -Djdk.tls.trustNameService=true \
        -Dosgi.console \
        -Declipse.consoleLog=true \
        -jar ${DIR}/plugins/org.eclipse.equinox.launcher_${org.eclipse.equinox.launcher.version}.jar \
        -configuration  /tmp/.kura/configuration
else
        echo "Failed to start Kura. It is already running ..."
fi]]>
        </echo>
        <echo
            file="${project.build.directory}/${build.output.name}/start_kura_background.sh"
            append="false"><![CDATA[#!/bin/sh

# Kura should be installed to the ${kura.install.dir} directory.
export PATH=/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/opt/jvm/bin:/usr/java/bin:$PATH
export MALLOC_ARENA_MAX=1

DIR=$(cd $(dirname $0)/..; pwd)
cd $DIR

# set up the configuration area
mkdir -p /tmp/.kura/configuration
${DIR}/bin/gen_config_ini.sh ${DIR}/framework/config.ini ${DIR}/plugins > /tmp/.kura/configuration/config.ini

KURA_RUNNING=`ps ax | grep java | grep "org.eclipse.equinox"`

#get java version
JAVA_VERSION=$(java -version 2>&1 | awk -F '"' '/version/ {print $2}')
JAVA_VERSION_NUM=$(echo "$JAVA_VERSION" | awk -F. '{printf("%03d%03d",$1,$2);}')

OPEN_MODULE_OPTIONS=''

if [ $JAVA_VERSION_NUM -gt 001008 ] ; then
        OPEN_MODULE_OPTIONS="--add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED"
fi

if [ -z "$KURA_RUNNING" ] ; then
  nohup java -Xms${kura.mem.size} -Xmx${kura.mem.size} \
        -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/var/log/kura-heapdump.hprof \
        -XX:ErrorFile=/var/log/kura-error.log \
        -XX:+IgnoreUnrecognizedVMOptions \
        ${OPEN_MODULE_OPTIONS} \
        --add-modules=ALL-SYSTEM \
        -Dkura.os.version=${kura.os.version} \
        -Dkura.arch=${kura.arch} \
        -Dtarget.device=${target.device} \
        -Declipse.ignoreApp=true \
        -Dkura.home=${DIR} \
        -Dkura.configuration=file:${DIR}/framework/kura.properties \
        -Dkura.custom.configuration=file:${DIR}/user/kura_custom.properties \
        -Ddpa.configuration=${DIR}/packages/dpa.properties \
        -Dlog4j.configurationFile=file:${DIR}/log4j/log4j.xml \
        -Djava.security.policy=${DIR}/framework/jdk.dio.policy \
        -Djdk.dio.registry=${DIR}/framework/jdk.dio.properties \
        -Djdk.tls.trustNameService=true \
        -Dosgi.console=5002 \
        -Declipse.consoleLog=true >> /var/log/kura-console.log 2>> /var/log/kura-console.log \
        -jar ${DIR}/plugins/org.eclipse.equinox.launcher_${org.eclipse.equinox.launcher.version}.jar \
        -configuration /tmp/.kura/configuration &

    #Save the PID
    KURA_PID=$!
    echo "Kura Started (pid="$KURA_PID") ..." >> /var/log/kura-console.log
    echo $KURA_PID > /var/run/kura.pid
else
    echo "Failed to start Kura. It is already running ..." >> /var/log/kura-console.log
fi]]>
        </echo>

        <!-- Populate parameters -->
        <copy file="src/main/resources/${build.name}/kura_install.sh"
            tofile="${project.build.directory}/${build.output.name}/kura_install.sh" />
        <copy file="src/main/resources/common/kura.init.yocto"
            tofile="${project.build.directory}/${build.output.name}/kura.init.yocto"
            failonerror="false" />
        <copy file="src/main/resources/common/kura.init.raspbian"
            tofile="${project.build.directory}/${build.output.name}/kura.init.raspbian"
            failonerror="false" />
        <copy file="src/main/resources/common/kura.service"
            tofile="${project.build.directory}/${build.output.name}/kura.service"
            failonerror="false" />
        <replaceregexp
            file="${project.build.directory}/${build.output.name}/kura_install.sh"
            match="INSTALL_DIR=.*" replace="INSTALL_DIR=${kura.install.dir}" />
        <replaceregexp
            file="${project.build.directory}/${build.output.name}/kura.init.yocto"
            match="INSTALL_DIR=.*" replace="INSTALL_DIR=${kura.install.dir}" />
        <replaceregexp
            file="${project.build.directory}/${build.output.name}/kura.init.raspbian"
            match="INSTALL_DIR=.*" replace="INSTALL_DIR=${kura.install.dir}" />
        <replaceregexp
            file="${project.build.directory}/${build.output.name}/kura.service"
            match="INSTALL_DIR" replace="${kura.install.dir}" />

        <zip destfile="${project.build.directory}/${build.output.name}.zip">

            <zipfileset
                file="${project.build.directory}/${build.output.name}/snapshot_0.xml"
                prefix="${build.output.name}/${snapshots.folder}/" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/config.ini"
                prefix="${build.output.name}/${framework.config.folder}/" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/jdk.dio.policy"
                prefix="${build.output.name}/${framework.config.folder}/" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/jdk.dio.properties"
                prefix="${build.output.name}/${framework.config.folder}/" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/cacerts.ks"
                prefix="${build.output.name}/${security.folder}/" />

            <zipfileset file="src/main/resources/common/kura_custom.properties"
                prefix="${build.output.name}/${user.config.folder}/" />

            <zipfileset file="src/main/resources/common/favicon/favicon-16x16.png"
                prefix="${build.output.name}/${console.folder}/skin/" />
            <zipfileset file="src/main/resources/common/favicon/favicon-32x32.png"
                prefix="${build.output.name}/${console.folder}/skin/" />
            <zipfileset file="src/main/resources/common/favicon/favicon-96x96.png"
                prefix="${build.output.name}/${console.folder}/skin/" />
            <zipfileset file="src/main/resources/common/favicon/favicon.ico"
                prefix="${build.output.name}/${console.folder}/skin/" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/kura_install.sh"
                prefix="${build.output.name}/${install.folder}/" filemode="700" />

            <zipfileset
                file="src/main/resources/common/manage_kura_users.sh"
                prefix="${build.output.name}/${install.folder}/" filemode="700" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/kura.service"
                prefix="${build.output.name}/${install.folder}" />
            <zipfileset file="src/main/resources/${build.name}/firewall.service"
                prefix="${build.output.name}/${install.folder}" filemode="700" />
            <zipfileset file="src/main/resources/${build.name}/firewall.init"
                prefix="${build.output.name}/${install.folder}" filemode="700" />
            <zipfileset file="src/main/resources/${build.name}/iptables.init"
                prefix="${build.output.name}/${install.folder}" filemode="700" />

            <zipfileset file="src/main/resources/common/kura-tmpfiles.conf"
                prefix="${build.output.name}/${install.folder}" />

            <zipfileset file="src/main/resources/${build.name}/kura.logrotate"
                prefix="${build.output.name}/${install.folder}" />

            <zipfileset file="src/main/resources/common/find_net_interfaces.py"
                prefix="${build.output.name}/${install.folder}" />
            <zipfileset file="src/main/resources/common/comment_interfaces_file.py"
                prefix="${build.output.name}/${install.folder}" />
            <zipfileset file="src/main/resources/common/customize-installation.sh"
                prefix="${build.output.name}/${install.folder}" />
            <zipfileset dir="src/main/resources/common/jdk-dio-properties"
                prefix="${build.output.name}/${install.folder}">
                <include name="*" />
            </zipfileset>
            <zipfileset dir="src/main/resources/common/iptables"
                prefix="${build.output.name}/${install.folder}">
                <include name="*" />
            </zipfileset>
            <zipfileset dir="src/main/resources/common/snapshots"
                prefix="${build.output.name}/${install.folder}">
                <include name="*" />
            </zipfileset>
            
            <zipfileset file="src/main/resources/common/named/named.ca"
                prefix="${build.output.name}/${install.folder}" />
            <zipfileset file="src/main/resources/common/named/named.rfc1912.zones"
                prefix="${build.output.name}/${install.folder}" />
            <zipfileset file="src/main/resources/common/named/usr.sbin.named"
                prefix="${build.output.name}/${install.folder}" />

            <zipfileset file="src/main/resources/common/dnsmasq"
                prefix="${build.output.name}/${install.folder}" />

            <zipfileset
                file="${project.build.directory}/${build.output.name}/start_kura.sh"
                fullpath="${build.output.name}/${binary.folder}/start_kura.sh"
                filemode="777" />
            <zipfileset
                file="${project.build.directory}/${build.output.name}/start_kura_debug.sh"
                fullpath="${build.output.name}/${binary.folder}/start_kura_debug.sh"
                filemode="777" />
            <zipfileset
                file="${project.build.directory}/${build.output.name}/start_kura_background.sh"
                fullpath="${build.output.name}/${binary.folder}/start_kura_background.sh"
                filemode="777" />
            <zipfileset
                file="src/main/resources/common/gen_config_ini.sh"
                fullpath="${build.output.name}/${binary.folder}/gen_config_ini.sh"
                filemode="777" />

            <zipfileset file="RELEASE_NOTES.txt"
                prefix="${build.output.name}/${framework.config.folder}/" />
            <zipfileset file="notice.html" prefix="${build.output.name}/" />
            <zipfileset file="epl-v10.html" prefix="${build.output.name}/" />
            <zipfileset file="src/main/resources/${build.name}/log4j.xml"
                prefix="${build.output.name}/${log4j.folder}/" />
            <zipfileset
                file="${project.build.directory}/${build.output.name}/kura.properties"
                prefix="${build.output.name}/${framework.config.folder}/" />

            <zipfileset dir="${kura.osgi.repo}/plugins/" prefix="${build.output.name}/${plugins.folder}">

                <include name="org.eclipse.osgi_*.jar" />
                <include name="org.eclipse.equinox.launcher_*.jar" />

            </zipfileset>

            <zipfileset dir="${project.build.directory}/${build.output.name}/plugins"
                prefix="${build.output.name}/${plugins.folder}">

            </zipfileset>

        </zip>

        <echo message="Building Kura Distribution for ${build.name}-jars..." />

        <!-- Create installer script -->
        <echo message="Creating Installer for ${build.name}  ${kura.install.dir}" />
        <exec executable="${project.build.directory}/../src/main/sh/create_installer.sh">
            <arg value="${project.build.directory}" />
            <arg value="${build.output.name}.zip" />
            <arg value="kura_${project.version}_${build.name}_installer.sh" />
            <arg value="${build.name}" />
            <arg value="${kura.install.dir}" />
        </exec>

        <!-- Get version information for the bundles/files in this build -->
        <echo
            message="Gathering version information for the bundles/files in ${build.name}" />
        <exec executable="src/main/sh/get_build_versions.sh">
            <arg value="${project.build.directory}" />
            <arg value="${build.output.name}.zip" />
            <arg value="kura_${project.version}_${build.name}.catalog" />
            <arg value="${build.name}" />
        </exec>


        <!-- Diff with the previous version -->
        <property file="RELEASE_INFO/version.properties" />
        <echo
            message="Diff version information with ${build.name} version ${kura.project.version.previous}" />
        <exec executable="src/main/sh/diff_build_versions.sh">
            <arg
                value="RELEASE_INFO/${kura.project.version.previous}/kura_${kura.project.version.previous}_${build.name}.catalog" />
            <arg value="${project.build.directory}/${build.output.name}.catalog" />
            <arg
                value="${project.build.directory}/kura_${kura.project.version.previous}_to_${project.version}_${build.name}" />
            <arg value="${build.name}" />
        </exec>


        <!-- Create upgrader -->
        <echo message="Creating Upgrader for ${build.name}" />
        <exec executable="${project.build.directory}/../src/main/sh/create_upgrader.sh">
            <arg value="${project.build.directory}" />
            <arg value="${project.build.directory}/${build.output.name}.zip" />
            <arg value="kura_${project.version}_${build.name}_upgrade.zip" />
            <arg value="KURA_${kura.project.version.previous}" />
            <arg value="${kura.install.dir}" />
            <arg value="${build.output.name}" />
            <arg
                value="kura_${kura.project.version.previous}_to_${project.version}_${build.name}.removed" />
            <arg
                value="kura_${kura.project.version.previous}_to_${project.version}_${build.name}.keep" />
            <arg value="${build.output.name}_upgrader.sh" />
            <arg value="${build.name}" />
        </exec>
    </target>

    <target name="copy-jdk-dio-resources" unless="is.docker">
        <copy file="src/main/resources/${build.name}/jdk.dio.properties"
            tofile="${project.build.directory}/${build.output.name}/jdk.dio.properties" failonerror="false" />
        <copy file="src/main/resources/common/jdk.dio.policy"
            tofile="${project.build.directory}/${build.output.name}/jdk.dio.policy" />
    </target>

    <!-- OSGi base configs -->
    <target name="osgi-base-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.cm_${org.eclipse.equinox.cm.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.sun.misc_${org.eclipse.kura.sun.misc.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.common_${org.eclipse.equinox.common.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.registry_${org.eclipse.equinox.registry.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.http.registry_${org.eclipse.equinox.http.registry.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.console_${org.eclipse.equinox.console.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.ds_${org.eclipse.equinox.ds.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.event_${org.eclipse.equinox.event.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.io_${org.eclipse.equinox.io.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.metatype_${org.eclipse.equinox.metatype.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.util_${org.eclipse.equinox.util.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.osgi.service.http.whiteboard_${org.osgi.service.http.whiteboard.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.http.service.api_${org.eclipse.equinox.http.service.api.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.osgi.services_${org.eclipse.osgi.services.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.osgi.util_${org.eclipse.osgi.util.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.scr_${org.apache.felix.scr.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.gogo.command_${org.apache.felix.gogo.command.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.gogo.runtime_${org.apache.felix.gogo.runtime.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.gogo.shell_${org.apache.felix.gogo.shell.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.knowhowlab.osgi.monitoradmin_${org.knowhowlab.osgi.monitoradmin.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.dependencymanager_${org.apache.felix.dependencymanager.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.deploymentadmin_${org.apache.felix.deploymentadmin.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.wireadmin_${org.eclipse.equinox.wireadmin.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.http.jetty_${org.eclipse.equinox.http.jetty.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.jetty.customizer_${org.eclipse.kura.jetty.customizer.version}.jar" />
            <param name="start.level" value="6" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.equinox.http.servlet_${org.eclipse.equinox.http.servlet.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.jetty.ee8.jetty-ee8-security_${org.eclipse.jetty.ee8.jetty-ee8-security.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>    	
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.jetty.ee8.jetty-ee8-servlet_${org.eclipse.jetty.ee8.jetty-ee8-servlet.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.jetty.ee8.jetty-ee8-nested_${org.eclipse.jetty.ee8.jetty-ee8-nested.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="javax.servlet_${javax.servlet.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.commons-fileupload_${org.apache.commons.commons-fileupload.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.commons-io_${org.apache.commons.commons-io.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="slf4j.api_${slf4j.api.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jcl.over.slf4j_${jcl.over.slf4j.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="log4j2-api-config_${log4j2-api-config.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.logging.log4j.api_${log4j.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.logging.log4j.core_${log4j.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.logging.log4j.slf4j.impl_${log4j.version}.jar" />
            <param name="start.level" value="1" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="minimal-json_${com.eclipsesource.minimal-json.version}.jar" />
            <param name="start.level" value="6" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.h2database.h2_${com.h2database.h2.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.codeminders.hidapi.${native.tag}_${com.codeminders.hidapi.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.codeminders.hidapi_${com.codeminders.hidapi.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.soda.dk.comm.${native.tag}_${org.eclipse.soda.dk.comm.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.soda.dk.comm_${org.eclipse.soda.dk.comm.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.lang3_${org.apache.commons.lang3.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.usb4java_${org.usb4java.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="usb4java-javax_${usb4java-javax.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jdk.dio.${native.tag}_${jdk.dio.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jdk.dio_${jdk.dio.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.commons-net_${org.apache.commons.commons-net.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.exec_${org.apache.commons.exec.version}.jar" />
            <param name="start.level" value="6" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.eclipsesource.jaxrs.jersey-min_${com.eclipsesource.jaxrs.jersey-min.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.eclipsesource.jaxrs.publisher_${com.eclipsesource.jaxrs.publisher.jar.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.eclipsesource.jaxrs.provider.gson_${com.eclipsesource.jaxrs.provider.gson.jar.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.eclipsesource.jaxrs.provider.security_${com.eclipsesource.jaxrs.provider.security.jar.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.eclipsesource.jaxrs.provider.multipart_${com.eclipsesource.jaxrs.provider.multipart.jar.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.google.gson_${com.google.gson.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.google.protobuf_${com.google.protobuf.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.csv_${org.apache.commons.csv.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.felix.useradmin_${org.apache.felix.useradmin.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.useradmin.store_${org.eclipse.kura.useradmin.store.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="bcpkix_${org.bouncycastle.jar.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="bcprov_${org.bouncycastle.jar.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="bctls_${org.bouncycastle.jar.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="bcutil_${org.bouncycastle.jar.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="bcpg_${org.bouncycastle.jar.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="bluez-dbus-osgi_${bluez-dbus-osgi.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jakarta.activation-api_${jakarta.activation-api.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jakarta.xml.bind-api_${jakarta.xml.bind-api.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jakarta.xml.ws-api_${jakarta.xml.ws-api.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="jakarta.xml.soap-api_${jakarta.xml.soap-api.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.sun.xml.bind.jaxb-osgi_${jaxb-osgi.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.glassfish.hk2.osgi-resource-locator_${osgi-resource-locator.version}.jar" />
            <param name="start.level" value="2" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.eurotech.gpsd4java_${com.eurotech.gpsd4java.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.c3p0_${org.apache.servicemix.bundles.c3p0.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.zaxxer.HikariCP_${hikaricp.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.quartz-scheduler.quartz_${quartz.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
    </target>


    <!-- Kura config targets -->
    <target name="api-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.api_${org.eclipse.kura.api.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core_${org.eclipse.kura.core.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.system-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.system_${org.eclipse.kura.core.system.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.certificates-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.certificates_${org.eclipse.kura.core.certificates.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.cloud-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.cloud.base.provider_${org.eclipse.kura.cloud.base.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.cloud.command_${org.eclipse.kura.core.cloud.command.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.cloud.factory_${org.eclipse.kura.core.cloud.factory.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="cloud.mqtt.kapua-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.cloudconnection.kapua.mqtt.provider_${org.eclipse.kura.cloudconnection.kapua.mqtt.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="cloud.mqtt.eclipseiot-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.cloudconnection.eclipseiot.mqtt.provider_${org.eclipse.kura.cloudconnection.eclipseiot.mqtt.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="cloud.mqtt.raw-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.cloudconnection.eclipseiot.mqtt.provider_${org.eclipse.kura.cloudconnection.eclipseiot.mqtt.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.comm-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.comm_${org.eclipse.kura.core.comm.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.configuration-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.configuration_${org.eclipse.kura.core.configuration.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.crypto-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.crypto_${org.eclipse.kura.core.crypto.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.deployment-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.deployment_${org.eclipse.kura.core.deployment.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.identity-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.identity_${org.eclipse.kura.core.identity.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.inventory-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.inventory_${org.eclipse.kura.core.inventory.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.tamper-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.tamper.detection_${org.eclipse.kura.core.tamper.detection.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="core.net-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.net_${org.eclipse.kura.core.net.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.net.configuration_${org.eclipse.kura.net.configuration.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="deployment.agent-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.deployment.agent_${org.eclipse.kura.deployment.agent.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="linux.clock-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.clock_${org.eclipse.kura.linux.clock.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="linux.command-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.command_${org.eclipse.kura.linux.command.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="linux.position-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.position_${org.eclipse.kura.linux.position.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="linux.usb-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.usb.${native.tag}_${org.eclipse.kura.linux.usb.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.usb_${org.eclipse.kura.linux.usb.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="bluetooth-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.ble.provider_${org.eclipse.kura.ble.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.ble.ibeacon.provider_${org.eclipse.kura.ble.ibeacon.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.ble.eddystone.provider_${org.eclipse.kura.ble.eddystone.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="linux.watchdog-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.watchdog_${org.eclipse.kura.linux.watchdog.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="core.status-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.status_${org.eclipse.kura.core.status.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="web2-plugins" if="is.web2.jar.available">
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.gwt.user_${com.gwt.user.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.web2_${org.eclipse.kura.web2.version}.jar" />
            <param name="start.level" value="6" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.http.server.manager_${org.eclipse.kura.http.server.manager.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="gpio-plugins" if="linux.gpio.jar.present">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.gpio_${org.eclipse.kura.linux.gpio.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="emulator-gpio-plugins" unless="linux.gpio.jar.present">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.emulator.gpio_${org.eclipse.kura.emulator.gpio.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="emulator.usb-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.emulator.usb_${org.eclipse.kura.emulator.usb.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="emulator.watchdog-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.emulator.watchdog_${org.eclipse.kura.emulator.watchdog.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="asset-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.asset.provider_${org.eclipse.kura.asset.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.asset.cloudlet.provider_${org.eclipse.kura.asset.cloudlet.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.asset.helper.provider_${org.eclipse.kura.asset.helper.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.asset.provider_${org.eclipse.kura.rest.asset.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="rest-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.provider_${org.eclipse.kura.rest.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.cloudconnection.provider_${org.eclipse.kura.rest.cloudconnection.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.configuration.provider_${org.eclipse.kura.rest.configuration.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.inventory.provider_${org.eclipse.kura.rest.inventory.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.command.provider_${org.eclipse.kura.rest.command.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.packages.provider_${org.eclipse.kura.rest.packages.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.position.provider_${org.eclipse.kura.rest.position.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.security.provider_${org.eclipse.kura.rest.security.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.identity.provider_${org.eclipse.kura.rest.identity.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.service.listing.provider_${org.eclipse.kura.rest.service.listing.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.system.provider_${org.eclipse.kura.rest.system.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.wire.provider_${org.eclipse.kura.rest.wire.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.request.handler.jaxrs_${org.eclipse.kura.request.handler.jaxrs.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.keystore.provider_${org.eclipse.kura.rest.keystore.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="deployment-hooks-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.hook.file.move.provider_${org.eclipse.kura.hook.file.move.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="marshallers-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.json.marshaller.unmarshaller.provider_${org.eclipse.kura.json.marshaller.unmarshaller.provider.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.xml.marshaller.unmarshaller.provider_${org.eclipse.kura.xml.marshaller.unmarshaller.provider.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="wires-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.driver.helper.provider_${org.eclipse.kura.driver.helper.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.localization_${org.eclipse.kura.localization.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.localization.resources_${org.eclipse.kura.localization.resources.version}.jar" />
            <param name="start.level" value="6" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.util_${org.eclipse.kura.util.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.h2db.component.provider_${org.eclipse.kura.wire.h2db.component.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.db.component.provider_${org.eclipse.kura.wire.db.component.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.component.provider_${org.eclipse.kura.wire.component.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.helper.provider_${org.eclipse.kura.wire.helper.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.provider_${org.eclipse.kura.wire.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.component.join.provider_${org.eclipse.kura.wire.component.join.provider.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="h2db-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.db.h2db.provider_${org.eclipse.kura.db.h2db.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <!-- Camel config targets -->
    <target name="camel-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.camel.sun.misc_${org.eclipse.kura.camel.sun.misc.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.camel.camel-amqp_${org.apache.camel.camel-amqp.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.camel.camel-core_${org.apache.camel.camel-core.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.camel.camel-core-osgi_${org.apache.camel.camel-core-osgi.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.camel.camel-jms_${org.apache.camel.camel-jms.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.camel.camel-script_${org.apache.camel.camel-script.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.camel.camel-stream_${org.apache.camel.camel-stream.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.camel_${org.eclipse.kura.camel.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.camel.cloud.factory_${org.eclipse.kura.camel.cloud.factory.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.camel.xml_${org.eclipse.kura.camel.xml.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.wire.camel_${org.eclipse.kura.wire.camel.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.qpid.jms.client_${apache-qpid-jms-client.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.qpid.proton-j_${apache-qpid-proton-j.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.spring-beans_${spring.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.spring-context_${spring.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.spring-core_${spring.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.spring-expression_${spring.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.spring-jms_${spring.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.servicemix.bundles.spring-tx_${spring.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <!-- Artemis config targets -->
    <target name="artemis-plugins">

        <antcall target="install-plugin">
            <param name="bundle.file" value="com.google.guava.failureaccess_${failureaccess.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="com.google.guava_${guava.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.buffer_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.codec_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.codec-http_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.codec-mqtt_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.common_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.handler_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.resolver_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.transport_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.transport-classes-epoll_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.transport-native-epoll_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.transport-classes-kqueue_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.transport-native-kqueue_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="io.netty.transport-native-unix-common_${io.netty.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.activemq.artemis-mqtt-protocol_${org.apache.activemq.artemis.upstream.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.activemq.artemis-native_${org.apache.activemq.artemis.upstream.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.beanutils_${commons-beanutils.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.commons.collections_${commons-collections.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.geronimo.specs.geronimo-jms_2.0_spec_${org.apache.geronimo.specs.jms.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.geronimo.specs.geronimo-json_1.0_spec_${org.apache.geronimo.specs.json.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.geronimo.specs.geronimo-jta_1.1_spec_${org.apache.geronimo.specs.jta.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.jboss.logging.jboss-logging_${org.jboss.logging.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.apache.activemq.artemis_${org.apache.activemq.artemis.version}.jar" />
            <param name="start.level" value="3" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.broker.artemis.core_${org.eclipse.kura.broker.artemis.core.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.broker.artemis.simple.mqtt_${org.eclipse.kura.broker.artemis.simple.mqtt.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.broker.artemis.xml_${org.eclipse.kura.broker.artemis.xml.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="emulator-plugins" if="is.nn">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.emulator_${org.eclipse.kura.emulator.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.emulator.net_${org.eclipse.kura.emulator.net.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="linux-network-plugins" unless="is.nn">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.net_${org.eclipse.kura.linux.net.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.linux.systemd.provider_${org.eclipse.kura.linux.systemd.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.nm_${org.eclipse.kura.nm.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.net.admin.firewall_${org.eclipse.kura.net.admin.firewall.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.network.status.provider_${org.eclipse.kura.rest.network.status.provider.version}.jar" />
            <param name="start.level" value="5" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.rest.network.configuration.provider_${org.eclipse.kura.rest.network.configuration.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.network.threat.manager_${org.eclipse.kura.network.threat.manager.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>
		
    <target name="event-publisher-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.event.publisher_${org.eclipse.kura.event.publisher.version}.jar" />
            <param name="start.level" value="6" />
            <param name="start" value="" />
        </antcall>
    </target>

    <target name="misc-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.misc.cloudcat_${org.eclipse.kura.misc.cloudcat.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="keystore-management-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.core.keystore_${org.eclipse.kura.core.keystore.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="filesystem-logprovider-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.log.filesystem.provider_${org.eclipse.kura.log.filesystem.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="container-orchestrator-plugins" unless="is.docker">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.container.orchestration.provider_${org.eclipse.kura.container.orchestration.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.container.provider_${org.eclipse.kura.container.provider.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

    <target name="configuration.change.manager-plugins">
        <antcall target="install-plugin">
            <param name="bundle.file" value="org.eclipse.kura.configuration.change.manager_${org.eclipse.kura.configuration.change.manager.version}.jar" />
            <param name="start.level" value="4" />
            <param name="start" value="s" />
        </antcall>
    </target>

</project>