webpackJsonp([7],{1713:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1714),n(1717),n(1719),n(1721),n(1723),n(1725),n(1727),n(1729),n(1731),n(1733),n(1735)},1714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1715),i=n(1716),a=function(){function e(e,t,n,o,i,a,s,r,c,l,d,u,p){var g=this;this.$rootScope=e,this.esTranslate=t,this.loggingService=n,this.resources=o,this.$sce=i,this.utilityService=r,this.tooltipService=c,this.mobileUpsellActionHandler=l,this.analyticsService=u,this.$state=p,this.tooltipId=r.generateUUID(),this.context.isValid=void 0,this.isSmsEnabled=this.context.control.options&&this.context.control.options.enableSms,this.showMobileBadges=this.context.control.options&&this.context.control.options.showMobileBadges;var m=this.context.control.options&&this.context.control.options.preFillEmail,h=this.context.control.options&&this.context.control.options.smsEnabledDescriptionResxKey,v=this.context.control.options&&this.context.control.options.emailDescriptionResxKey,y=this.context.control.options&&this.context.control.options.smsEnabledPlaceHolderResxKey,f=this.context.control.options&&this.context.control.options.emailPlaceHolderResxKey,S=s.valueFor(a.settings.names.webserviceEnvironmentName),b=!S||/prod-usea|prod-uswe|prod-usce|dev-local|skypespacesdev/.test(S);this.isSmsEnabled=this.isSmsEnabled&&b,!this.isSmsEnabled&&m&&d.getUserInformation().then(function(e){g.context.value=e.userName,g.validateInput()}),this.description=this.isSmsEnabled?h?t.instant(h):t.instant(o.strings.mobile_upsell_dialog_email_prefill_instruction):v?t.instant(v):t.instant(o.strings.mobile_upsell_dialog_instruction),this.placeholder=this.isSmsEnabled?y?t.instant(y):t.instant(o.strings.mobile_upsell_dialog_input_placeholder_email_sms):f?t.instant(f):t.instant(o.strings.mobile_upsell_dialog_input_placeholder_email),this.infoBubbleText=this.isSmsEnabled?[t.instant(o.strings.mobile_upsell_sms_disclaimer),t.instant(o.strings.mobile_upsell_phone_caveat)]:[t.instant(o.strings.mobile_upsell_email_disclaimer)],this.sendPanelViewEvent()}return e.$inject=["$rootScope","esTranslate","loggingService","resources","$sce","constants","settingsService","utilityService","tooltipService","mobileUpsellActionHandler","authenticationService","analyticsService","$state"],e.prototype.showInfoTooltip=function(e,t){var n=angular.extend(this.$rootScope.$new(),this),o={template:i,trigger:"manual",container:"body",placement:"right",autoClose:!0,scope:n},a={sourceElement:angular.element(e.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:o,tooltipId:this.tooltipId};t?this.tooltipService.showTooltip(a):this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.tooltipId)},e.prototype.trustAsHtml=function(e){return this.$sce.trustAsHtml(e)},e.prototype.validateInputOnKeyUp=function(){this.context.isValid=void 0,this.errorText=void 0,this.isInputValid()&&(this.context.isValid=!0)},e.prototype.validateInput=function(){if(this.context.isValid=this.isInputValid(),this.errorText=void 0,!this.context.isValid){var e=/^\d*$/.test(_.trim(this.context.value).replace(/\W*/g,""));this.errorText=this.isSmsEnabled&&e?this.esTranslate.instant(this.resources.strings.mobile_upsell_mobile_phone_validation_error):this.esTranslate.instant(this.resources.strings.mobile_upsell_email_validation_error)}},e.prototype.isInputValid=function(){var e=!1;if(this.context.phoneNumber=void 0,validator.isEmail(this.context.value))e=!0;else if(this.isSmsEnabled){var t=libphonenumber.PhoneNumberUtil.getInstance(),n=_.trim(this.context.value).replace(/\W*/g,"");n.startsWith("1")?n="+"+n:n.startsWith("+1")||(n="+1"+n);try{var o=t.parse(n);(e=10===o.getNationalNumber().toString().length)&&(this.context.phoneNumber=o)}catch(t){e=!1}}return e},Object.defineProperty(e.prototype,"buttonText",{get:function(){return this.context.isLoading?this.esTranslate.instant(this.resources.strings.mobile_upsell_sending_link):this.esTranslate.instant(this.resources.strings.mobile_upsell_dialog_send_link)},enumerable:!0,configurable:!0}),e.prototype.sendLink=function(){this.mobileUpsellActionHandler.handleAction(this.context.dialogCtrl)},e.prototype.sendPanelViewEvent=function(){this.analyticsService.sendPanelView({panel:{launchMethod:teamspace.components.LaunchMethod[teamspace.components.LaunchMethod.direct],previousUri:void 0,previousUriParams:void 0,region:teamspace.PanelRegion[teamspace.PanelRegion.modal],uri:this.$state.current.name,uriParams:this.loggingService.hashUriParamsPII(this.$state.params),viewId:this.utilityService.generateUUID(),type:teamspace.PanelType[teamspace.PanelType.engagementSurfaceEmailSmsControl]},dataBag:{sendLinkOption:this.isSmsEnabled?"EmailAndSMS":"EmailOnly",id:this.context.id,treatment:this.context.treatment}})},e}();t.EngagementSurfaceEmailSmsControl=a,angular.module("teamspace.engagementSurfaceEmailSmsControl",["teamspace.esTranslate","teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.tooltipService","teamspace.authenticationService","teamspace.esActionHandler","teamspace.engagementSurfaceMobileBadgesControl"]).component("engagementSurfaceUicontrolEmailSms",{bindings:{context:"<"},template:o,controller:a})},1715:function(e,t){e.exports='<div class="es-email-sms" ng-class="{ \'without-mobile-badges\': !$ctrl.showMobileBadges }" data-tid="es-email-sms">\n  <p class="es-text">\n    <span ng-bind-html="::$ctrl.trustAsHtml($ctrl.description)"></span>\n\n    <span class="es-email-sms-description-info">\n      <a class="info-link" ng-if="::$ctrl.infoBubbleText.length" ng-mouseenter="::$ctrl.showInfoTooltip($event, true)" ng-mouseleave="::$ctrl.showInfoTooltip($event, false)">\n        <ng-include src="\'svg/icons-info.html\'"></ng-include>\n      </a>\n    </span>\n  </p>\n\n  <div class="es-input">\n    <span class="es-input-wrapper">\n      <input sanitized id="email-sms-form" class="form-control" acc-focus-default aria-label="{{::$ctrl.description}}" ng-blur="$ctrl.context.value && $ctrl.validateInput()" ng-keyup="::$ctrl.validateInputOnKeyUp()" ng-readonly="$ctrl.context.isLoading" type="text" placeholder="{{::$ctrl.placeholder}}" spellcheck="false" ng-model="$ctrl.context.value"/>\n\n      <ng-include class="icon error" ng-if="$ctrl.context.isValid === false" src="\'svg/icons-input-invalid.html\'"></ng-include>\n\n      <ng-include class="icon valid" ng-if="$ctrl.context.isValid" src="\'svg/icons-input-valid.html\'"></ng-include>\n    </span>\n\n    <button class="ts-btn ts-btn-primary inset-border" ng-click="$ctrl.sendLink()" ng-disabled="!$ctrl.context.isValid" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-name="{{::$root.trackConstants.trackModuleName.engagementSurfaceDialogButton}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceSendLinkButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-data="{ sendType: {{$ctrl.context.phoneNumber ? \'\\\'SMS\\\'\' : \'\\\'Email\\\'\'}},\n                          id: \'{{$ctrl.context.id}}\',\n                          treatment: \'{{$ctrl.context.treatment}}\' }" data-tid="es-email-sms-send-link-btn">\n      <busy-animation size="small" ng-if="$ctrl.context.isLoading"></busy-animation>\n      <span ng-bind="$ctrl.buttonText"></span>\n    </button>\n\n  </div>\n\n  <div class="validation-error-contents">\n    <p class="form-field-error es-text small" aria-live="assertive" ng-if="$ctrl.context.isValid === false" role="alert">\n      <span ng-bind="::$ctrl.errorText"></span>\n    </p>\n  </div>\n\n  <engagement-surface-uicontrol-mobile-badges ng-if="$ctrl.showMobileBadges" context="$ctrl.context"></engagement-surface-uicontrol-mobile-badges>\n\n</div>'},1716:function(e,t){e.exports='<div class="tooltip-container input-info-text">\n  <div class="content-container">\n    <div class="tooltip-arrow-left"></div>\n    <span class="tooltip-content">\n      <div ng-repeat="text in infoBubbleText track by $index">\n        <p class="es-text small" ng-bind="::text"></p>\n      </div>\n    </span>\n  </div>\n</div>\n'},1717:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1718),i=function(){function e(e,t,n,o,i,a,s,r,c,l){var d=this;this.esTranslate=e,this.resources=t,this.$sce=o,this.analyticsService=i,this.ariaLiveService=a,this.updateDiscoverySettingsActionHandler=l,this.hideCheckboxes=!1,this.clickedCount=0,this.remindMeLaterEnabled=!1,this.isSuccess=!1,this.didFocusOnSecondaryButton=!1,this.logger=s.newLogger("EngagementSurfaceDiscoverySettingsControl"),this.context.isValid=void 0;var u=this.context.control.options&&this.context.control.options.titleResxKey,p=this.context.control.options&&this.context.control.options.bodyResxKey,g=this.context.control.options&&this.context.control.options.enableRemindMeLater;this.title=e.instant(u),this.description=e.instant(p),this.learnMoreLink=n.akaMs.teamDiscoverySettingUrl,this.remindMeLaterEnabled=g,this.context.handleError=this.handleError.bind(this),this.context.handleSuccess=this.handleSuccess.bind(this),this.context.isLoading=!0,this.context.erroredSettings=[],r.getNonDiscoverableTeams().then(function(e){var t=c.createOrderedTeamLists(e);if(d.context.discoverySettings=t.favoriteTeamsByOrder.concat(t.moreTeamsByName).map(function(e){return{team:e,isDiscoverable:!1,retryFailed:!1}}),1===d.context.discoverySettings.length)d.hideCheckboxes=!0,d.clickedCount=1,d.context.discoverySettings[0].isDiscoverable=!0;else if(d.context.discoverySettings.length<1)return void d.context.dialogCtrl.close();d.context.isLoading=!1,setTimeout(function(){var e=d.hideCheckboxes?angular.element("#btn-make-discoverable")[0]:angular.element(".es-discovery-settings .app-checkbox--input")[0];e&&e.focus()}),d.sendOpenEvent()}).catch(function(e){d.context.dialogCtrl.close()})}return e.$inject=["esTranslate","resources","constants","$sce","analyticsService","ariaLiveService","loggingService","channelService","channelTeamSortHelper","updateDiscoverySettingsActionHandler"],e.prototype.trustAsHtml=function(e){return this.$sce.trustAsHtml(e)},Object.defineProperty(e.prototype,"bulkOperationButtonText",{get:function(){return this.clickedCount==this.context.discoverySettings.length?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_unselect_all):this.esTranslate.instant(this.resources.strings.discovery_setting_promo_select_all)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryButtonText",{get:function(){return this.remindMeLaterEnabled&&!this.errorState?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_remind_later):this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_cancel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryButtonText",{get:function(){return this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_make_discoverable)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryButtonLabel",{get:function(){return this.context.isSuccess?" ":this.context.isPending?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_pending):this.hideCheckboxes?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_make_discoverable_single,{teamName:"teamName"},{teamName:this.context.discoverySettings[0].team.displayName}):this.primaryButtonText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorState",{get:function(){return this.context.erroredSettings&&this.context.erroredSettings.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorText",{get:function(){return this.context.erroredSettings?this.context.isPending?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_error_retrying):1===this.context.erroredSettings.length?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_error_single,{teamCount:"teamCount"},{teamCount:this.context.erroredSettings.length}):this.esTranslate.instant(this.resources.strings.discovery_setting_promo_error_plural,{teamCount:"teamCount"},{teamCount:this.context.erroredSettings.length}):""},enumerable:!0,configurable:!0}),e.prototype.bulkOperation=function(){this.clickedCount==this.context.discoverySettings.length?this.unselectAll():this.selectAll()},e.prototype.selectAll=function(){this.context.discoverySettings.forEach(function(e){e.isDiscoverable=!0}),this.clickedCount=this.context.discoverySettings.length,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.discovery_setting_promo_selected_all_announcement))},e.prototype.unselectAll=function(){this.context.discoverySettings.forEach(function(e){e.isDiscoverable=!1}),this.clickedCount=0,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.discovery_setting_promo_unselected_all_announcement))},e.prototype.handleToggleSetting=function(e){e.isDiscoverable?this.clickedCount++:this.clickedCount--},e.prototype.generateSettingTrackConstants=function(e){var t=!e.isDiscoverable;return{trackScenario:t?teamspace.components.PanelActionScenario.selected:teamspace.components.PanelActionScenario.unselected,trackName:teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,trackType:teamspace.components.PanelModuleType.checkbox,trackSummary:t?"Team selected in ReviewTeamDiscoverySettings":"Team unselected in ReviewTeamDiscoverySettings",trackOutcome:t?teamspace.components.PanelActionOutcome.checked:teamspace.components.PanelActionOutcome.unchecked,trackData:{count:this.context.discoverySettings.length,clickCount:t?this.clickedCount+1:this.clickedCount-1,teamId:e.team.objectId}}},e.prototype.tryAgain=function(){this.context.discoverySettings.forEach(function(e){e.retryFailed=!1}),this.updateDiscoverySettingsActionHandler.handleAction(this.context.dialogCtrl)},e.prototype.onFocusOnSecondaryButton=function(){if(!this.didFocusOnSecondaryButton){var e=this.hideCheckboxes?angular.element("#btn-make-discoverable")[0]:angular.element(".es-discovery-settings .app-checkbox--input")[0];e&&e.focus(),this.didFocusOnSecondaryButton=!0}},e.prototype.dismissDialog=function(){var e=this.remindMeLaterEnabled&&!this.errorState;this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.closeDialog,e?teamspace.components.PanelActionScenario.remindMeLater:teamspace.components.PanelActionScenario.cancel,teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,e?"Remind me Later selected for ReviewTeamDiscoverySettings":"ReviewTeamDiscoverySettings cancelled",{count:this.context.discoverySettings.length}),this.context.dialogCtrl.close()},e.prototype.updateSettings=function(){this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.submit,teamspace.components.PanelActionScenario.makeDiscoverable,teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,"Make Discoverable selected for ReviewTeamDiscoverySettings",{count:this.clickedCount}),this.updateDiscoverySettingsActionHandler.handleAction(this.context.dialogCtrl)},e.prototype.handleError=function(){var e=this.context.erroredSettings?this.context.erroredSettings.length:0;this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.error,teamspace.components.PanelModuleName.errorReviewTeamDiscoverySettings,"ReviewTeamDiscoverySettings update failed",{count:e}),this.ariaLiveService.update(this.errorText,!0)},e.prototype.handleSuccess=function(){var e=this,t=this.context.erroredSettings?this.context.erroredSettings.length:0,n=this.clickedCount-t;this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.closeDialog,teamspace.components.PanelActionScenario.success,teamspace.components.PanelModuleName.successReviewTeamDiscoverySettings,"ReviewTeamDiscoverySettings update successful",{count:n}),this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.discovery_setting_promo_success_title),!0),setTimeout(function(){e.context.dialogCtrl.close()},3e3)},e.prototype.sendOpenEvent=function(){this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.openDialog,teamspace.components.PanelActionScenario.openDiscoverySettingDialog,teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,"Appearance of review team discovery settings pop up",{count:this.context.discoverySettings.length},void 0,this.remindMeLaterEnabled?"ZeroReminder":"FirstReminder")},e.prototype.sendTelemetryEvent=function(e,t,n,o,i,a,s){var r={panel:{type:teamspace.PanelType[teamspace.PanelType.engagementSurfaceDialog]},action:{gesture:teamspace.components.PanelActionGesture[teamspace.components.PanelActionGesture.click],outcome:teamspace.components.PanelActionOutcome[e],scenario:teamspace.shared.AttributeHelper.tryGetEnum(t.toString(),teamspace.components.PanelActionScenario,this.logger)},module:{name:teamspace.components.PanelModuleName[n],type:teamspace.components.PanelModuleType[teamspace.components.PanelModuleType.discoverySettingsDialog],summary:o}};i&&(r.dataBag=i),a&&(r.team=a),s&&(r.module.state=s),this.analyticsService.sendPanelAction(r)},e}();t.EngagementSurfaceDiscoverySettingsControl=i,angular.module("teamspace.engagementSurfaceDiscoverySettingsControl",["teamspace.esTranslate","teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.esActionHandler","teamspace.channelTeamSortHelper"]).component("engagementSurfaceUicontrolDiscoverySettings",{bindings:{context:"<"},template:o,controller:i})},1718:function(e,t){e.exports='<div class="es-discovery-settings" data-tid="es-discovery-settings" role="dialog" aria-labelledby="ds-title" aria-describedby="ds-description">\n\n  \x3c!-- Text --\x3e\n  <span ng-if="!$ctrl.context.isSuccess" id="ds-title" class="ds-title app-font-title2-bold" ng-bind="$ctrl.title"></span>\n\n  <p class="es-text" ng-if="!$ctrl.errorState && !$ctrl.context.isSuccess">\n    <span id="ds-description" ng-bind-html="::$ctrl.trustAsHtml($ctrl.description)"></span>\n    <a href="{{::$ctrl.learnMoreLink}}" target="_blank" translate-once="{{::$root.resources.strings.discovery_setting_promo_learn_more}}"></a>\n  </p>\n\n  \x3c!-- Loading indicator --\x3e\n  <div ng-if="$ctrl.context.isLoading" class="centered-container">\n    <busy-animation size="medium"></busy-animation>\n  </div>\n\n  <div ng-if="$ctrl.context.isSuccess" class="centered-container success-container">\n    <ng-include src="\'svg/icons-accept.html\'"></ng-include>\n    <span class="ds-title ds-success-title app-font-title2-bold" translate-once="{{::$root.resources.strings.discovery_setting_promo_success_title}}"></span>\n  </div>\n\n  \x3c!-- Team list --\x3e\n  <div ng-if="!$ctrl.context.isLoading && !$ctrl.errorState && !$ctrl.context.isSuccess" class="teams-list-container">\n    <div ng-if="!$ctrl.hideCheckboxes" class="teams-list-header">\n      <span id="team-name-header" class="team-name-header">Your private teams</span>\n      <a class="team-setting-header" href="#" ng-click="$ctrl.bulkOperation()" role="button" aria-describedby="team-name-header" track-scenario="{{$ctrl.clickedCount != $ctrl.context.discoverySettings.length ? $root.trackConstants.trackScenario.selectAllClicked : $root.trackConstants.trackScenario.unselectAllClicked}}" track-outcome="{{$ctrl.clickedCount != $ctrl.context.discoverySettings.length ? $root.trackConstants.trackOutcome.checked : $root.trackConstants.trackOutcome.unchecked}}" track-name="{{::$root.trackConstants.trackModuleName.reviewTeamDiscoverySettings}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{count: $ctrl.context.discoverySettings.length}" track-summary="{{$ctrl.clickedCount != $ctrl.context.discoverySettings.length ? \'Select all clicked for ReviewTeamDiscoverySettings\' : \'Unselect all clicked for ReviewTeamDiscoverySettings\'}}" ng-bind="$ctrl.bulkOperationButtonText"></a>\n    </div>\n    <div ng-class="{\'teams-list-overflow-shadow\': $ctrl.context.discoverySettings.length > 10}" simple-scrollbar>\n      <ul class="teams-list">\n        <li ng-repeat="discoverySetting in $ctrl.context.discoverySettings track by $index" class="teams-list-item">\n          <profile-picture css-class="team-icon" class="team-profile-pic" title="{{::discoverySetting.team.displayName}}" display-name="discoverySetting.team.displayName" team-id="discoverySetting.team.siteInfo.groupId" etag="discoverySetting.team.pictureETag" aria-hidden="true" retain-in-cache="true">\n          </profile-picture>\n          <span ng-if="$ctrl.hideCheckboxes" class="team-displayname">{{::discoverySetting.team.displayName}}</span>\n          <teams-checkbox ng-if="!$ctrl.hideCheckboxes" class="team-setting-checkbox" on-click="$ctrl.handleToggleSetting(discoverySetting)" ng-model="discoverySetting.isDiscoverable" swap-order="true" is-disabled="$ctrl.context.isPending" generate-track-constants-function="$ctrl.generateSettingTrackConstants(discoverySetting)" label-text="{{::discoverySetting.team.displayName}}" narrator-text="{{::discoverySetting.team.displayName}}">\n          </teams-checkbox>\n        </li>\n      </ul>\n    </div>\n  </div>\n\n  \x3c!-- Team list (error state) --\x3e\n  <div ng-if="$ctrl.errorState && !$ctrl.context.isSuccess" class="teams-list-container">\n      <div class="teams-list-header error-list-header">\n        <span id="ds-error-text" ng-bind="$ctrl.errorText"></span>\n        <a id="ds-try-again" class="inline-link" href="#" ng-click="$ctrl.tryAgain()" role="button" acc-role="focus-default" aria-describedby="ds-error-text" track-scenario="{{::$root.trackConstants.trackScenario.tryAgain}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-name="{{::$root.trackConstants.trackModuleName.reviewTeamDiscoverySettings}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{count: $ctrl.context.erroredSettings.length}" track-summary="Try again clicked for ReviewTeamDiscoverySettings" translate-once="{{::$root.resources.strings.discovery_setting_promo_error_try_again}}"></a>\n      </div>\n      <div ng-class="{\'teams-list-overflow-shadow\': $ctrl.context.erroredSettings.length > 10}" simple-scrollbar>\n        <ul class="teams-list">\n          <li ng-repeat="discoverySetting in $ctrl.context.erroredSettings track by $index" class="teams-list-item">\n            <profile-picture css-class="team-icon" class="team-profile-pic" title="{{::discoverySetting.team.displayName}}" display-name="discoverySetting.team.displayName" team-id="discoverySetting.team.siteInfo.groupId" etag="discoverySetting.team.pictureETag" aria-hidden="true" retain-in-cache="true">\n            </profile-picture>\n            <span class="team-displayname">{{::discoverySetting.team.displayName}}</span>\n            <div class="error-status-wrapper">\n                <ng-include ng-if="discoverySetting.retryFailed" class="error-icon" src="\'svg/icons-call-alert.html\'"></ng-include>\n                <busy-animation ng-if="!discoverySetting.retryFailed && $ctrl.context.isPending" size="small"></busy-animation>\n            </div>\n          </li>\n        </ul>\n      </div>\n    </div>\n\n  \x3c!-- Buttons --\x3e\n  <div ng-if="!$ctrl.context.isLoading && !$ctrl.context.isSuccess" class="buttons-container">\n    <button type="button" class="ts-btn ts-btn-secondary shadow-level-1" ng-click="$ctrl.dismissDialog()" ng-focus="$ctrl.onFocusOnSecondaryButton()" track-click-silent="true" aria-labelledby="secondary-btn-text">\n      <span id="secondary-btn-text" class="btn-text" ng-bind="$ctrl.secondaryButtonText"></span>\n    </button>\n    <button ng-if="!$ctrl.errorState" type="button" id="btn-make-discoverable" class="ts-btn ts-btn-primary shadow-level-1" ng-click="$ctrl.updateSettings()" ng-disabled="$ctrl.clickedCount == 0" track-click-silent="true" aria-label="{{::$ctrl.primaryButtonLabel}}" aria-describedby="{{$ctrl.context.isPending ? \'\' : \'ds-description\'}}">\n      <busy-animation aria-hidden="true" size="small" ng-if="$ctrl.context.isPending"></busy-animation>\n      <span aria-hidden="true" class="btn-text" ng-if="!$ctrl.context.isPending" ng-bind="$ctrl.primaryButtonText"></span>\n    </button>\n  </div>\n</div>'},1719:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1720),i=function(){function e(e,t,n){var o=n.getFileExtension(this.src).toLowerCase(),i=_.indexOf(t.fileExtensions.html,o)>=0;this.control=this.context.control,this.src=this.control.src,this.altText=e.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.cssClass=[this.control.background,this.control.customClass,i?"es-html":"es-image"]}return e.$inject=["esTranslate","constants","utilityService"],e}();t.EngagementSurfaceImageControl=i,angular.module("teamspace.engagementSurfaceImageControl",["teamspace.esTranslate","teamspace.utilityService","teamspace.constants"]).component("engagementSurfaceUicontrolImage",{bindings:{context:"<"},template:o,controller:i})},1720:function(e,t){e.exports='<render-image src="::$ctrl.src" css-class="::$ctrl.cssClass" alt="::$ctrl.altText">\n</render-image>'},1721:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1722),i=function(){function e(e,t,n,o){this.constants=t,this.control=this.context.control;var i=this.control.removeDefaultMargin?"remove-default-margin":"";this.cssClass=[this.control.background,this.control.align,i];var a=o.getLocale(),s=t.growth.engagementSurfaces.mobileUpsell.badge.apple,r=t.growth.engagementSurfaces.mobileUpsell.badge.google,c=t.growth.engagementSurfaces.mobileUpsell.badge.microsoft;this.badges=[{display:!0,src:this.getBadgeLink(s,a),fallbackSrc:this.getBadgeLink(s),href:t.growth.engagementSurfaces.mobileUpsell.iOSLink,alt:e.instant(n.strings.mobile_upsell_ios_alt_text),trackSummaryName:s},{display:!0,src:this.getBadgeLink(r,a),fallbackSrc:this.getBadgeLink(r),href:t.growth.engagementSurfaces.mobileUpsell.androidLink,alt:e.instant(n.strings.mobile_upsell_android_alt_text),trackSummaryName:r},{display:!1,src:this.getBadgeLink(c,a),fallbackSrc:this.getBadgeLink(c),href:t.growth.engagementSurfaces.mobileUpsell.windowsPhoneLink,alt:e.instant(n.strings.mobile_upsell_windows_phone_alt_text),trackSummaryName:c}]}return e.$inject=["esTranslate","constants","resources","localizationService"],e.prototype.getBadgeLink=function(e,t){return void 0===t&&(t="en-us"),""+this.constants.growth.engagementSurfaces.mobileUpsell.mobileDownloadCdnBase+t+"/"+e+".png"},e}();t.EngagementSurfaceMobileBadgesControl=i,angular.module("teamspace.engagementSurfaceMobileBadgesControl",["teamspace.esTranslate","teamspace.constants","teamspace.locales","teamspace.localizationService"]).component("engagementSurfaceUicontrolMobileBadges",{bindings:{context:"<?"},template:o,controller:i})},1722:function(e,t){e.exports='<div class="es-mobile-badges" ng-class="::$ctrl.cssClass">\n  \x3c!-- empty ng-click is required for keyboard navigation in accessibility --\x3e\n  <a class="mobile-badge-link" ng-repeat="badge in $ctrl.badges track by $index" ng-if="badge.display" ng-href="{{::badge.href}}" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceDialogButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.button}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Click on mobile download badge {{::badge.trackSummaryName}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                   treatment: \'{{$ctrl.context.treatment}}\' }" target="_blank" ng-click="">\n    <img ng-src="{{::badge.src}}" fallback-src="{{::badge.fallbackSrc}}" ng-attr-alt="{{::badge.alt}}">\n  </a>\n</div>'},1723:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1724),i=n(2),a=function(){function e(e,t){if(this.logger=e.newLogger("EngagementSurfaceTextControl"),this.control=this.context.control,i.IsUserInterfaceControlText(this.context.control)){this.text=t.instant(this.context.control.resxKey,this.context.control.resxParams,this.context.context);var n=this.context.control.removeDefaultMargin?"remove-default-margin":"";this.cssClass=[this.context.control.size,this.context.control.weight,this.context.control.align,this.context.control.padding,this.context.control.background,n]}else{var o=(this.context.control||{}).type;this.logger.error("unknown control: "+o)}}return e.$inject=["esLogger","esTranslate"],e}();t.EngagementSurfaceTextControl=a,angular.module("teamspace.engagementSurfaceTextControl",["teamspace.esTranslate","teamspace.esLogger"]).component("engagementSurfaceUicontrolText",{bindings:{context:"<"},template:o,controller:a})},1724:function(e,t){e.exports='<p class="es-text" ng-class="::$ctrl.cssClass">{{::$ctrl.text}}</p>'},1725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1726),i=function(){function e(e){this.control=this.context.control,this.url=this.control.url,this.text=e.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.cssClass=[this.control.size,this.control.weight,this.control.align,this.control.padding,this.control.background]}return e.$inject=["esTranslate"],e}();t.EngagementSurfaceLinkControl=i,angular.module("teamspace.engagementSurfaceLinkControl",["teamspace.esTranslate"]).component("engagementSurfaceUicontrolLink",{bindings:{context:"<"},template:o,controller:i})},1726:function(e,t){e.exports='<a class="es-link" ng-class="::$ctrl.cssClass" ng-click="" href="{{::$ctrl.url}}" target="_blank" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceSendLink}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.linkViewButton}}" track-type="{{::$root.trackConstants.trackType.link}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                 treatment: \'{{$ctrl.context.treatment}}\' }">{{::$ctrl.text}}</a>\n'},1727:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1728),i=function(){function e(e,t){this.control=this.context.control,this.text=e.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.tooltip=t.actionTitle(this.control.actionKey),this.biActionKey=t.parseActionKey(this.control.actionKey).key}return e.$inject=["esTranslate","esActionHandler"],e.prototype.onClick=function(){this.context.dialogCtrl.onButtonClick(this.control.actionKey)},e}();t.EngagementSurfaceContentButtonControl=i,angular.module("teamspace.engagementSurfaceContentButtonControl",["teamspace.esTranslate","teamspace.esActionHandler"]).component("engagementSurfaceUicontrolContentButton",{bindings:{context:"<"},template:o,controller:i})},1728:function(e,t){e.exports='<button class="es-content-button ts-btn" ng-class="::{\'ts-btn-secondary\': !$ctrl.control.isPrimary,\n                   \'ts-btn-primary inset-border\': $ctrl.control.isPrimary}" ng-attr-title="{{::$ctrl.tooltip}}" ng-click="$ctrl.onClick()" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceDialogButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.button}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                      treatment: \'{{$ctrl.context.treatment}}\',\n                      isPrimary: \'{{$ctrl.control.isPrimary}}\',\n                      actionKey: \'{{$ctrl.biActionKey}}\' }">{{::$ctrl.text}}</button>'},1729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1730),i=function(){function e(e,t){this.utilityService=e,this.control=this.context.control,this.title=t.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.link=t.instant(this.control.linkContent,this.control.linkContentParams,this.context.context),this.copyLinkIcon=this.control.icon,this.linkCopied=!1,this.cssClass=this.control.cssClass}return e.$inject=["utilityService","esTranslate"],e.prototype.copyLink=function(){this.utilityService.copyToClipboard(this.link),this.title=this.control.copiedText,this.copyLinkIcon=this.control.copiedIcon,this.linkCopied=!0},e}();t.EngagementSurfaceCopyLinkButtonControl=i,angular.module("teamspace.engagementSurfaceCopyLinkButtonControl",["teamspace.esTranslate","teamspace.utilityService"]).component("engagementSurfaceUicontrolCopyLinkButton",{bindings:{context:"<"},template:o,controller:i})},1730:function(e,t){e.exports='<button ng-class="::$ctrl.cssClass" ng-click="$ctrl.copyLink()" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceDialogButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.button}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                      treatment: \'{{$ctrl.context.treatment}}\'}">\n  <ng-include class="icon icons-default-fill" src="$ctrl.copyLinkIcon" ng-class="{ \'copied\': $ctrl.linkCopied }"/>\n  <div class="title-container">\n    <div class="copy-button-title" translate="{{$ctrl.title}}"></div>\n    <div class="copy-link-text">{{$ctrl.link}}</div>\n  </div>\n</button>'},1731:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1732),a=function(e){function t(t,n,o,i,a,s,r,c,l,d,u,p){var g=e.call(this,t,n,o,i,a,s,r,c,l,d,u,p)||this;return g.$q=t,g.$scope=n,g.$translate=o,g.authenticationService=i,g.constants=a,g.ariaLiveService=s,g.loggingService=r,g.peopleService=c,g.resources=l,g.utilityService=d,g.Upload=u,g.settingsService=p,g.context.onSave=g.onSave.bind(g),g.isFre=!0,g.saveButtonControl={type:"button",actionKey:a.growth.engagementSurfaces.actionKey.updateUserProfile,resxKey:l.strings.update_user_profile_fre_next,isPrimary:!0,disabled:!c.isValidName(g.currentUserDisplayName)},g.skipButtonControl={type:"button",resxKey:l.strings.update_user_profile_skip,isPrimary:!1,disabled:!1},g.context.dialogCtrl.updateButtonControls([g.saveButtonControl]),g}return o(t,e),t.$inject=["$q","$scope","$translate","authenticationService","constants","ariaLiveService","loggingService","peopleService","resources","utilityService","Upload","settingsService"],Object.defineProperty(t.prototype,"uploadButtonText",{get:function(){return this.resources.strings.user_profile_picture_upload_fre},enumerable:!0,configurable:!0}),t.prototype.evaluateSaveBtnState=function(){var e=this;_(this.context.dialogCtrl.footerButtons).filter(function(e){return e.dataBag.isPrimary}).forEach(function(t){return t.disabled=!e.peopleService.isValidName(e.currentUserDisplayName)})},t.prototype.close=function(){this.userPictureContext.close(),this.context.dialogCtrl.close()},t.prototype.displaySkipAndSaveButton=function(){this.saveButtonControl&&this.skipButtonControl&&(this.saveButtonControl.resxKey=this.resources.strings.update_user_profile_fre_retry,this.context.dialogCtrl.updateButtonControls([this.skipButtonControl,this.saveButtonControl]))},t}(n(176).UpdateUserProfileController);t.EngagementSurfaceUpdateUserProfileControl=a,angular.module("teamspace.engagementSurfaceUpdateUserProfileControl",["ngFileUpload","pascalprecht.translate","teamspace.locales","teamspace.authenticationService","teamspace.constants","teamspace.loggingService","teamspace.peopleService","teamspace.dialogService","teamspace.utilityService","teamspace.settingsService","teamspace.ariaLiveService"]).component("engagementSurfaceUicontrolUpdateUserProfile",{bindings:{context:"<"},template:i,controller:a})},1732:function(e,t){e.exports='<div class="es-update-user-profile update-user-profile-dialog">\n  <div class="name-container">\n    <section class="name-input-field">\n      <label id="uupcDisplayNameLabel" for="displayname" class="form-field-title">\n             {{::$ctrl.displayNameFieldTitle}}\n      </label>\n      <div class="form-field-container">\n        <input sanitized type="text" id="displayname" aria-labelledby="uupcDisplayNameLabel" data-tid="updateUserProfile-displayNameInputField" ng-model="$ctrl.currentUserDisplayName" ng-change="$ctrl.evaluateSaveBtnState()"/>\n        <busy-animation class="update-name-indicator update-name" ng-if="$ctrl.isUpdatingName" size="small" context="update-user-display-name"></busy-animation>\n        <ng-include class="update-name-indicator icon green-svg" ng-if="$ctrl.showDisplayNameChangeSuccess" src="\'svg/icons-accept.html\'"></ng-include>\n      </div>\n    </section>\n  </div>\n  <div class="error-container" ng-if="$ctrl.updateNameErrorMessage" aria-live="assertive" role="alert">\n       {{$ctrl.updateNameErrorMessage}}\n  </div>\n  <div class="update-user-profile-content" ng-if="::$ctrl.enableFreUploadPicture">\n    <div class="image-container">\n      <div ng-if="!$ctrl.isUploadingPicture" class="profile-img-parent medium-image-size">\n        <profile-picture ng-if="!$ctrl.newPhoto" css-class="image-mask" principal-name="::$ctrl.currentUserUpn" display-name="::$ctrl.currentUserDisplayName" size="::$ctrl.constants.profilePictureSizes.large" source="change-user-picture"></profile-picture>\n        <div ngf-background="$ctrl.newPhoto" ng-if="$ctrl.newPhoto" class="image-mask medium-image-size"></div>\n      </div>\n      <busy-animation class="change-picture" ng-if="$ctrl.isUploadingPicture" size="medium" context="upload-profile-picture"></busy-animation>\n    </div>\n    <div class="buttons-container">\n      <button class="btn btn-default app-icons-fill-focus action-button" data-tid="updateUserProfile-uploadPictureBtn" ngf-model-invalid="$ctrl.invalidFile" ngf-dimensions="{{::$ctrl.profilePictureNgfParams.dimensions}}" ngf-max-size="{{::$ctrl.profilePictureNgfParams.maxSize}}" ngf-select="$ctrl.uploadPhoto($file)" ng-model="$ctrl.newPhoto" ng-disabled="$ctrl.uploadButton.disabled" ngf-pattern="\'{{::$ctrl.profilePictureNgfParams.profilePicturePattern}}\'" accept="{{::$ctrl.profilePictureNgfParams.profilePictureAccept}}" aria-labelledby="{{::$ctrl.uploadButton.id}}">\n        \x3c!-- Required for flexbox to work on Firefox --\x3e\n        <div class="update-user-picture-item-container">\n          <ng-include class="ts-sym" src="\'svg/icons-files-upload.html\'"></ng-include>\n          <div id="{{::$ctrl.uploadButton.id}}" class="action-button-text" translate-once="{{::$ctrl.uploadButtonText}}"></div>\n        </div>\n      </button>\n      <div class="error-container error-message-container" ng-if="$ctrl.uploadPictureErrorMessage" aria-live="assertive" role="alert">\n        {{$ctrl.uploadPictureErrorMessage}}\n      </div>\n    </div>\n  </div>\n</div>\n'},1733:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1734),a=function(){function e(e,t,n,o,i,a,s,r,c,l,d,u,p,g){var m=this;this.$q=e,this.$rootScope=t,this.loggingService=o,this.constants=i,this.settingsService=a,this.analyticsService=s,this.localizationService=r,this.ariaLiveService=c,this.resources=l,this.esTranslate=d,this.appStateService=u,this.lazyLoadService=p,this.placeholderId="ts-one-player-container",this.autoCloseDefaults={videoStatusCheckIntervalInMs:5e3,videoStatusCheckMaxTime:6,videoStalledTimeoutInMs:1e4},this.verboseLoggingDefaults={enableMediaEventsLogging:!1,enableDebugLogging:!1},this.initialized=!1,this.videoEnded=!1,this.videoPaused=!1,this.currentVideoCheckpoint=0,this.mediaEvents=[],this.videoStatusCheckCount=0,this.showButtons=!1,this.videoReady=!1,this.showCloseButton=!1,this.showReplayButton=!1,this.isInteractive=!0,this.control=this.context.control,this.videoId=this.getVideoId(this.control.videoIds),this.logger=g.newLogger("EngagementSurfaceVideoControl"),this.videoLoadScenario=o.newScenario(i.scenarios.firstRun.freVideoLoad),this.videoLoadScenario.cancelIfOffline=!0,this.videoLoadScenario.appendEventData({videoId:this.videoId,id:this.context.id,treatment:this.context.treatment}),this.videoLoadScenario.mark("Video_dialog_showed"),this.playerEventListener=function(e){return m.playerEventCallback(e)},this.videoId?(n.$on("$destroy",function(){m.destroy()}),this.loadScript().then(function(){try{m.logLoadStep("Video_library_loaded"),m.showCloseButton=!!m.control.showCloseButton,m.showReplayButton=!!m.control.showReplayButton,m.isInteractive=!!m.control.isInteractive,m.control.autoCloseOptions=_.merge({},m.autoCloseDefaults,m.control.autoCloseOptions),m.control.verboseLoggingOptions=_.merge({},m.verboseLoggingDefaults,m.control.verboseLoggingOptions),m.loadVideo()}catch(e){m.logErrorAndClose("Exception from render() function",e)}}).catch(function(e){m.logErrorAndClose("Load script error",e)}),this.checkVideoStatus()):this.logErrorAndClose("Video id is not valid")}return e.$inject=["$q","$rootScope","$scope","loggingService","constants","settingsService","analyticsService","localizationService","ariaLiveService","resources","esTranslate","appStateService","lazyLoadService","esLogger"],e.prototype.getVideoId=function(e){if(e){var t=this.localizationService.getSupportedVideoLocale(this.localizationService.getLocale(),e,null);return t&&e[t]}return null},e.prototype.loadScript=function(){var e=this;if(window.MsOnePlayer)return this.$q.resolve();var t=this.$q.defer();return this.onePlayerJsUrl=this.settingsService.valueFor(this.constants.settings.names.onePlayerJsUrl),this.lazyLoadService.loadFromUrl("MsOnePlayer",this.onePlayerJsUrl).then(function(){if(window.MsOnePlayer)t.resolve();else{var n="MsOnePlayer not defined after loading OnePlayer library.";e.logger.error(n),t.reject(n)}}).catch(function(n){e.logger.error("Failed to load one player script from "+e.onePlayerJsUrl+". Error: "+JSON.stringify(n)+"."),t.reject(n)}),t.promise},e.prototype.loadVideo=function(){var e=this,t={options:{autoplay:!!this.control.autoPlay,mute:!!this.control.mute,controls:!!this.control.showPlayerControls,showEndImage:!!this.control.showEndImage},metadata:{videoId:this.videoId}};window.MsOnePlayer.render(this.placeholderId,t,function(t){t?(e.onePlayer=t,e.logLoadStep("Video_player_loaded"),t.addPlayerEventListener(e.playerEventListener)):e.logErrorAndClose("Player is undefined")})},e.prototype.checkVideoStatus=function(){var e=this;this.videoStatusCheckIntervalVar=setInterval(function(){!e.videoReady&&e.videoStatusCheckCount++<e.control.autoCloseOptions.videoStatusCheckMaxTime?(e.logLoadStep("Video_stillloading"),e.logMediaEvents("ESP video still loading")):(e.videoStatusCheckIntervalVar&&(clearInterval(e.videoStatusCheckIntervalVar),e.videoStatusCheckIntervalVar=void 0),e.videoReady||e.logErrorAndClose("Video still not playing"))},this.control.autoCloseOptions.videoStatusCheckIntervalInMs)},e.prototype.initialize=function(){var e=this;this.initialized||(this.initialized=!0,this.videoReady=!0,this.$rootScope.$apply(),this.videoDuration=this.onePlayer.getDuration(),this.videoLoadScenario.stop(),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoStart)),angular.element("body .ngdialog-overlay").on("click",function(){e.sendVideoTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.clickOutsideVideo,{videoPercent:e.videoPercent})}),angular.element("#engagement-surface-dialog #ts-es-video-player-overlay").on("contextmenu",function(e){e.preventDefault()})},e.prototype.playerEventCallback=function(e){if(this.control.verboseLoggingOptions.enableMediaEventsLogging&&e&&"timeupdate"!=e.name&&this.mediaEvents.push(e),e&&e.name)switch(e.name){case"playing":this.initialize(),this.onVideoPlaying();break;case"ended":this.onVideoEnded();break;case"pause":this.onVideoPause();break;case"ContentCheckpoint":this.onVideoCheckpoint(e);break;case"loadstart":case"loadedmetadata":case"loadeddata":this.onVideoLoad(e);break;case"error":case"ContentError":case"PlayerError":this.onVideoError(e);break;case"stalled":this.onVideoStalled()}this.control.verboseLoggingOptions.enableDebugLogging&&console.log("ESP video event: "+JSON.stringify(e))},e.prototype.unregisterEvents=function(){this.onePlayer&&this.onePlayer.removePlayerEventListener(this.playerEventListener)},e.prototype.onVideoPause=function(){this.videoPaused=!0,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videopause))},e.prototype.onVideoCheckpoint=function(e){var t=e.data&&e.data.checkpoint&&e.data.checkpoint;_.isNil(t)&&(t=this.videoPercent),t&&t>this.currentVideoCheckpoint&&(this.currentVideoCheckpoint=t,this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoCheckpoint,{message:this.currentVideoCheckpoint}))},e.prototype.onVideoLoad=function(e){this.logLoadStep("Video_"+e.name)},e.prototype.onVideoError=function(e){this.logErrorAndClose("Video error",e)},e.prototype.onVideoStalled=function(){var e=this;_.isNil(this.videoStalledTimeoutVar)&&(this.videoStalledTimeoutVar=setTimeout(function(){e.logErrorAndClose("Video stalled too long"),e.videoStalledTimeoutVar=void 0},this.control.autoCloseOptions.videoStalledTimeoutInMs))},e.prototype.pauseOrPlay=function(){_.isNil(this.onePlayer)||(this.videoPaused||this.videoEnded?this.onePlayer.play():this.onePlayer.pause())},e.prototype.onVideoEnded=function(){this.showButtons=!0,this.videoEnded=!0,this.videoPaused=!1,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videoend)),this.$rootScope.$apply(),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoEnd)},e.prototype.handleKeyPress=function(e){e.which===this.constants.keyCodes.space&&this.pauseOrPlay()},e.prototype.handleKeyUp=function(e){e.which===this.constants.keyCodes.escape&&this.videoEnded&&(this.sendVideoTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.closeDialog,{closedBy:"escape"},!1),this.close())},e.prototype.watchAgain=function(){this.currentVideoCheckpoint=0,this.onePlayer.seek(0),this.onePlayer.play()},e.prototype.onVideoPlaying=function(){this.showButtons=!1,this.videoEnded=!1,this.videoPaused?(this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videoresume)),this.videoPaused=!1):this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videointro)+this.esTranslate.instant(this.control.narratorStringResxKey)),this.videoStalledTimeoutVar&&(clearTimeout(this.videoStalledTimeoutVar),this.videoStalledTimeoutVar=void 0),this.$rootScope.$apply(),angular.element("#engagement-surface-dialog #ts-es-video-player-overlay").focus()},e.prototype.close=function(){this.context.dialogCtrl.close()},Object.defineProperty(e.prototype,"videoPercent",{get:function(){return this.videoEnded?100:this.onePlayer?Math.round(this.onePlayer.getCurrentTime()/this.videoDuration*100):0},enumerable:!0,configurable:!0}),e.prototype.logMediaEvents=function(e){this.control.verboseLoggingOptions.enableMediaEventsLogging&&0!==this.mediaEvents.length&&(this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoStatus,{message:JSON.stringify(this.mediaEvents)},!1),this.logger.error(e+". "+this.getLoggingContext()+" Media events: "+JSON.stringify(this.mediaEvents)),this.mediaEvents=[])},e.prototype.logLoadStep=function(e){this.videoLoadScenario.mark(e),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoLoad,{message:e}),this.logger.info("Video load step: "+e+".")},e.prototype.getLoggingContext=function(){return"Id: "+this.context.id+". Treatment: "+this.context.treatment+". Video ID: "+this.videoId+"."},e.prototype.logErrorAndClose=function(e,t){var n=!this.appStateService.isOnline||!this.appStateService.isConnected;this.logMediaEvents("ESP video error");var o="ESP video error: "+e+". "+this.getLoggingContext();t&&(o+=" Error: "+JSON.stringify(t)+"."),n?this.videoLoadScenario.cancel({message:o}):this.videoLoadScenario.fail({message:o}),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoError,{message:o},!1),this.logger.error(o),this.close()},e.prototype.destroy=function(){this.unregisterEvents(),this.videoStatusCheckIntervalVar&&(clearInterval(this.videoStatusCheckIntervalVar),this.videoStatusCheckIntervalVar=void 0),this.videoStalledTimeoutVar&&(clearTimeout(this.videoStalledTimeoutVar),this.videoStalledTimeoutVar=void 0)},e.prototype.sendVideoTelemetry=function(e,t,n,i){var a=this;void 0===n&&(n=void 0),void 0===i&&(i=!0);var s={action:{gesture:e,outcome:teamspace.shared.AttributeHelper.tryGetEnum(t.toString(),teamspace.components.PanelActionOutcome,this.loggingService),scenario:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenario.esVideo.toString(),teamspace.components.PanelActionScenario,this.loggingService),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.video.toString(),teamspace.components.PanelActionScenarioType,this.loggingService)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.esVideo.toString(),teamspace.components.PanelModuleName,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.video.toString(),teamspace.components.PanelModuleType,this.loggingService),summary:"ESP Video"},dataBag:o({id:this.context.id+" - "+this.videoId,context:this.getLoggingContext(),treatment:this.context.treatment},n)};i?_.defer(function(){a.analyticsService.onPanelAction(a.$rootScope,s)}):this.analyticsService.onPanelAction(this.$rootScope,s)},e}();t.EngagementSurfaceVideoControl=a,angular.module("teamspace.engagementSurfaceVideoControl",["teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.dialogService","teamspace.analyticsService","teamspace.localizationService","teamspace.ariaLiveService","teamspace.esTranslate","teamspace.appState","teamspace.lazyLoadService"]).component("engagementSurfaceUicontrolVideo",{bindings:{context:"<"},template:i,controller:a})},1734:function(e,t){e.exports='<div id="ts-es-video-player" role="application" track-outcome="{{::$root.trackConstants.trackOutcome.clickInsideVideo}}" track-scenario="{{::$root.trackConstants.trackScenario.esVideo}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.video}}" track-name="{{::$root.trackConstants.trackModuleName.esVideo}}" track-type="{{::$root.trackConstants.trackType.video}}" track-summary="ES Video" track-data="{videoPercent: {{$ctrl.videoPercent}}, id: {{$ctrl.context.id}}, treatment: {{$ctrl.context.treatment}}}" ng-click="">\n  <div class="video-container">\n    <busy-animation ng-if="!$ctrl.videoReady" size="medium"></busy-animation>\n    <div id="ts-one-player-container" ng-show="$ctrl.videoReady" aria-hidden="true"></div>\n    <div id="ts-es-video-player-overlay" ng-if="!$ctrl.isInteractive" ng-click="$ctrl.pauseOrPlay()" ng-keypress="$ctrl.handleKeyPress($event)" ng-keyup="$ctrl.handleKeyUp($event)" set-focus="true" aria-label="{{::$root.resources.strings.firstrun_video_player_video|translate}}"></div>\n    <div class="ts-es-video-controls" ng-show="$ctrl.showButtons">\n      <button class="ts-es-video-controls-play ts-btn" ng-if="$ctrl.showReplayButton" translate-once="{{::$root.resources.strings.firstrun_video_player_watchagain}}" aria-label="{{::$root.resources.strings.firstrun_video_player_watchagain|translate}}" role="button" ng-click="$ctrl.watchAgain()" track-outcome="{{::$root.trackConstants.trackOutcome.videoStart}}" track-scenario="{{::$root.trackConstants.trackScenario.esVideo}}" track-name="{{::$root.trackConstants.trackModuleName.esVideo}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="ES Video - Watch again" track-data="{id: {{$ctrl.context.id}}, treatment: {{$ctrl.context.treatment}}}"/>\n      <button class="ts-es-video-controls-close ts-btn" ng-if="$ctrl.showCloseButton" translate-once="{{::$root.resources.strings.firstrun_video_player_letsgo}}" aria-label="{{::$root.resources.strings.firstrun_video_player_letsgo|translate}}" role="button" ng-click="$ctrl.close()" track-outcome="{{::$root.trackConstants.trackOutcome.closeDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.esVideo}}" track-name="{{::$root.trackConstants.trackModuleName.esVideo}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="ES Video - Lets go" track-data="{id: {{$ctrl.context.id}}, treatment: {{$ctrl.context.treatment}}}"/>\n    </div>\n  </div>\n</div>'},1735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1736),i=n(2),a=function(){function e(e,t,n,o,i,a){this.$scope=e,this.constants=t,this.esTranslate=n,this.resources=o,this.esSurfaceStack=i,this.esActionHandler=a,this.isLoading=!1,this._footerButtons=[],this.id=e.ngDialogData.id,this.treatment=e.ngDialogData.treatment;var s=e.ngDialogData.uiControls;this.params=e.ngDialogData.params||{},this.context=e.ngDialogData.context,this.closeViaX=this.closeViaX.bind(this),this.initButtons(s),this.contentControlContexts=this.getContentControlContexts(s),e.ngDialogData.scenario.stop()}return e.$inject=["$scope","constants","esTranslate","resources","esSurfaceStack","esActionHandler"],e.prototype.initButtons=function(e){var t=this;this._footerButtons.length=0,this.getButtonControls(e).forEach(function(e){t._footerButtons.push({disabled:!!e.disabled,func:function(){t.onButtonClick(e.actionKey)},secondaryStyle:!e.isPrimary,tid:"engagement-surface-"+t.id+"-btn-"+e.resxKey,text:t.esTranslate.instant(e.resxKey,e.resxParams,t.context),title:t.esActionHandler.actionTitle(e.actionKey),icon:e.icon,name:teamspace.components.PanelModuleName.engagementSurfaceDialogButton,type:teamspace.components.PanelModuleType.button,scenario:teamspace.components.PanelActionScenario.engagementSurfaceDialogButton,scenarioType:teamspace.components.PanelActionScenarioType.engagementSurface,outcome:e.isPrimary?teamspace.components.PanelActionOutcome.select:teamspace.components.PanelActionOutcome.closeDialog,dataBag:{id:t.id,treatment:t.treatment,isPrimary:e.isPrimary,actionKey:t.esActionHandler.parseActionKey(e.actionKey).key},summary:"enagement surface button isPrimary="+e.isPrimary+" resx="+e.resxKey})})},e.prototype.getUiControlComponentName=function(e){return"engagement-surface-uicontrol-"+(this.constants.growth.engagementSurfaces.uiControls[e.type]||this.constants.growth.engagementSurfaces.uiControls.text)},e.prototype.updateButtonControls=function(e){this.initButtons(e)},e.prototype.getButtonControls=function(e){var t=[];return(e||[]).forEach(function(e){i.IsUserInterfaceControlButton(e)&&t.push(e)}),t},e.prototype.getContentControlContexts=function(e){var t=this;return e.filter(function(e){return!i.IsUserInterfaceControlButton(e)}).map(function(e){return{id:t.id,treatment:t.treatment,isValid:!0,value:"",context:t.context,control:e,dialogCtrl:t}})},e.prototype.closeViaX=function(){this.onButtonClick(this.constants.growth.engagementSurfaces.actionKey.xClose)},e.prototype.onButtonClick=function(e){this.esSurfaceStack.setCurrentAction(e),this.errorText=void 0,this.esActionHandler.hasRegisteredAction(e)?this.esActionHandler.handleAction(e,this,this.context):this.$scope.closeThisDialog()},Object.defineProperty(e.prototype,"footerButtons",{get:function(){return this._footerButtons},enumerable:!0,configurable:!0}),e.prototype.getUiControls=function(){return this.contentControlContexts},e.prototype.setIsCompleted=function(e,t){var n=this;this.completedText=e,this.isLoading=!1,this._footerButtons.length=0,t&&this._footerButtons.push({disabled:!1,func:function(){n.completedText=void 0;var e=n.$scope.ngDialogData.uiControls;n.initButtons(e),n.getUiControls().forEach(function(e){return e.isHidden=!1})},secondaryStyle:!0,tid:"engagement-surface-"+this.id+"-btn-reset",text:t,name:teamspace.components.PanelModuleName.engagementSurfaceDialogButton,type:teamspace.components.PanelModuleType.button,scenario:teamspace.components.PanelActionScenario.engagementSurfaceDialogResetButton,scenarioType:teamspace.components.PanelActionScenarioType.engagementSurface,outcome:teamspace.components.PanelActionOutcome.resetDialog,dataBag:{id:this.id,treatment:this.treatment},summary:"enagement surface button to reset the dialog"}),this._footerButtons.push({disabled:!1,func:function(){n.onButtonClick(n.constants.growth.engagementSurfaces.actionKey.completedClose)},tid:"engagement-surface-"+this.id+"-btn-done",text:this.esTranslate.instant(this.resources.strings.done),name:teamspace.components.PanelModuleName.engagementSurfaceDialogButton,type:teamspace.components.PanelModuleType.button,scenario:teamspace.components.PanelActionScenario.engagementSurfaceDialogButton,scenarioType:teamspace.components.PanelActionScenarioType.engagementSurface,outcome:teamspace.components.PanelActionOutcome.closeDialog,dataBag:{id:this.id,treatment:this.treatment},summary:"enagement surface button to close the dialog"})},e.prototype.setErrorText=function(e){this.errorText=e},e.prototype.setIsLoading=function(e){this.isLoading=e},e.prototype.getIsLoading=function(){return this.isLoading},e.prototype.close=function(){this.$scope.closeThisDialog()},e}();t.EngagementSurfaceDialogController=a,angular.module("teamspace.engagementSurfaceDialog",["teamspace.esTranslate","teamspace.constants","teamspace.dialogService","teamspace.locales","teamspace.esSurfaceStack","teamspace.esActionHandler","teamspace.engagementSurfaceTextControl","teamspace.engagementSurfaceImageControl","teamspace.engagementSurfaceLinkControl","teamspace.engagementSurfaceContentButtonControl","teamspace.engagementSurfaceMobileBadgesControl","teamspace.engagementSurfaceEmailSmsControl","teamspace.engagementSurfaceUpdateUserProfileControl","teamspace.engagementSurfaceVideoControl","teamspace.engagementSurfaceDiscoverySettingsControl","teamspace.engagementSurfaceCopyLinkButtonControl"]).controller("EngagementSurfaceDialogController",a).run(["$templateCache",function(e){e.put("components/engagement-surface-dialog/engagement-surface-dialog.html",o)}]).run(["constants","dialogService",function(e,t){t.register(e.dialogs.engagementSurfaceDialog,{template:"components/engagement-surface-dialog/engagement-surface-dialog.html",className:"ts-modal-dialog",isPersistent:!0,closeByEscape:!1,closeByDocument:!1,showClose:!0,controller:"EngagementSurfaceDialogController",controllerAs:"$ctrl",ariaAuto:!1,ariaRole:"dialog",ariaDescribedById:"modalDialog-title"})}])},1736:function(e,t){e.exports='<div id="engagement-surface-dialog" data-tid="engagement-surface-dialog" ng-class="{ \'footer-hidden\': $ctrl.footerButtons.length === 0,\n                 \'center-align\': $ctrl.params.centerAlign,\n                 \'remove-default-padding\': $ctrl.params.removeDefaultPadding }">\n  <modal-dialog center-align-buttons="$ctrl.params.centerAlign" suppress-default-button="true" footer-buttons="$ctrl.footerButtons" add-close-icon="!$ctrl.params.hideCloseIcon" close-function="$ctrl.closeViaX" suppress-default-footer="$ctrl.footerButtons.length === 0" track-panel-type="{{::$root.trackConstants.panelType.engagementSurfaceDialog}}" track-data="{id: \'{{::$ctrl.id}}\', treatment: \'{{::$ctrl.treatment}}\'}">\n    <div id="es-content" class="content">\n      <div ng-repeat="controlContext in $ctrl.contentControlContexts track by $index">\n        <div ts-load-directive directive="::$ctrl.getUiControlComponentName(controlContext.control)" ng-hide="controlContext.isHidden" context="::controlContext"></div>\n      </div>\n    </div>\n    <div id="es-completed-text" class="es-completed-text es-text" ng-if="$ctrl.completedText" aria-live="assertive" role="alert" ng-bind="::$ctrl.completedText"></div>\n    <div class="form-field-error dialog-error" ng-if="$ctrl.errorText" aria-live="assertive">\n      <ng-include class="icon error" src="\'svg/icons-input-invalid.html\'"></ng-include>\n      <span ng-bind="::$ctrl.errorText"></span>\n    </div>\n  </modal-dialog>\n</div>\n'}},[1713]);
//# sourceMappingURL=https://statics.teams.microsoft.com/hashedjs/lazy-ng1-mod-engagement-surface-components.min.js-1e75ff65.map